<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµí†µ í˜„í™©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding-bottom: 80px;
        }
        
        /* í—¤ë” */
        .header {
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .header-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .header-icons {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .weather-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .weather-icon {
            font-size: 1.2rem;
        }
        
        .weather-details {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .weather-temp {
            font-weight: bold;
            color: #333;
            font-size: 0.9rem;
        }
        
        .weather-desc {
            font-size: 0.8rem;
            color: #666;
        }
        
        .rain-warning {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            background: #e3f2fd;
            color: #1976d2;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-top: 0.2rem;
        }
        
        .rain-icon {
            font-size: 0.9rem;
        }
        
        .rain-text {
            font-weight: bold;
        }
        
        .rain-location {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-top: 0.2rem;
        }
        
        .bell-icon {
            font-size: 1.2rem;
        }
        
        /* ì§€ì—° ì˜ˆìƒ ë°•ìŠ¤ */
        .delay-alert {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 1rem;
            margin: 1rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-left: 4px solid #2196f3;
        }
        
        .delay-icon {
            font-size: 1.5rem;
        }
        
        .delay-text {
            font-weight: bold;
            color: #1976d2;
        }
        
        /* ì§€í•˜ì²  ì „ìš© í—¤ë” */
        .subway-header {
            background: linear-gradient(135deg, #0052a4 0%, #00a5de 100%);
            padding: 1rem;
            margin: 1rem;
            border-radius: 12px;
            text-align: center;
        }
        
        .subway-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .subway-icon {
            font-size: 1.5rem;
        }
        
        /* í˜¼ì¡ë„ ì¹´ë“œ */
        .congestion-section {
            margin: 1.5rem 1rem;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .congestion-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }
        
        .congestion-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .congestion-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
        }
        
        .circle-smooth { background-color: #4caf50; }
        .circle-normal { background-color: #ff9800; }
        .circle-congested { background-color: #f44336; }
        
        .congestion-percentage {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .congestion-label {
            font-size: 1rem;
            font-weight: bold;
            color: #333;
        }
        
        /* ë…¸ì„ ë³„ í˜„í™© */
        .lines-section {
            margin: 1.5rem 1rem;
        }
        
        .line-card {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 0.8rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .line-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .line-number {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .line-1 { background-color: #0052a4; }
        .line-2 { background-color: #00a84d; }
        .line-3 { background-color: #ef7c1c; }
        .line-4 { background-color: #00a5de; }
        .line-5 { background-color: #996cac; }
        .line-6 { background-color: #cd7c2f; }
        .line-7 { background-color: #747f00; }
        .line-8 { background-color: #e6186c; }
        .line-9 { background-color: #bdb092; }
        
        .line-details h3 {
            font-size: 1rem;
            margin-bottom: 0.3rem;
        }
        
        .line-details p {
            font-size: 0.9rem;
            color: #666;
        }
        
        .line-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .status-smooth { background-color: #4caf50; }
        .status-normal { background-color: #ff9800; }
        .status-congested { background-color: #f44336; }
        
        .status-text {
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        /* ë¹ ë¥¸ ë©”ë‰´ */
        .quick-menu {
            margin: 1.5rem 1rem;
        }
        
        .quick-menu-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        
        .quick-menu-btn {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .quick-menu-btn:hover {
            transform: translateY(-2px);
        }
        
        .quick-menu-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .quick-menu-text {
            font-weight: bold;
            color: #333;
        }
        
        /* ìµœê·¼ ì—…ë°ì´íŠ¸ */
        .recent-updates {
            margin: 1.5rem 1rem;
        }
        
        .update-card {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .update-time {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .update-message {
            font-weight: bold;
            color: #333;
        }
        
        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 0.8rem;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            z-index: 100;
        }
        
        .nav-item {
            text-align: center;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .nav-item.active {
            background-color: #2196f3;
            color: white;
        }
        
        .nav-item:not(.active) {
            color: #666;
        }
        
        .nav-icon {
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }
        
        .nav-text {
            font-size: 0.8rem;
        }
        
        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2196f3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ì‹¤ì‹œê°„ ì±„íŒ… ìœ„ì ¯ */
        .chat-widget {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 450px;
            height: 550px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            display: none;
            flex-direction: column;
        }
        
        .chat-header {
            background: #2196f3;
            color: white;
            padding: 1rem;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-title {
            font-weight: bold;
        }
        
        .chat-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            max-height: 250px;
        }
        
        .chat-message {
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-radius: 8px;
            max-width: 80%;
        }
        
        .chat-message.user {
            background: #e3f2fd;
            margin-left: auto;
            text-align: right;
        }
        
        .chat-message.bot {
            background: #f5f5f5;
            margin-right: auto;
        }
        
        .chat-input {
            padding: 1rem;
            border-top: 1px solid #eee;
        }
        
        .chat-line-selector {
            margin-right: 1rem;
        }
        
        .chat-line-selector select {
            padding: 0.3rem 0.5rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            font-size: 0.9rem;
        }
        
        .chat-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 1rem;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
            color: #666;
        }
        
        .chat-line-info {
            font-weight: bold;
            color: #2196f3;
        }
        
        .chat-user-count {
            color: #666;
        }
        
        .chat-input {
            padding: 1rem;
            border-top: 1px solid #eee;
            display: flex;
            gap: 0.5rem;
        }
        
        .chat-input input {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }
        
        .chat-send-btn {
            padding: 0.5rem 1rem;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .chat-send-btn:hover {
            background: #1976d2;
        }
        
        .chat-message.line-specific {
            border-left: 3px solid #2196f3;
        }
        
        .chat-message.line-1 { border-left-color: #0052a4; }
        .chat-message.line-2 { border-left-color: #00a84d; }
        .chat-message.line-3 { border-left-color: #ef7c1c; }
        .chat-message.line-4 { border-left-color: #00a5de; }
        .chat-message.line-5 { border-left-color: #996cac; }
        .chat-message.line-6 { border-left-color: #cd7c2f; }
        .chat-message.line-7 { border-left-color: #747f00; }
        .chat-message.line-8 { border-left-color: #e6186c; }
        .chat-message.line-9 { border-left-color: #bdb092; }
        
        .chat-message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.25rem;
        }
        
        .chat-sender {
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .chat-line-badge {
            background: #2196f3;
            color: white;
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            font-size: 0.7rem;
        }
        
        .chat-timestamp {
            font-size: 0.7rem;
            color: #999;
        }
        
        /* ë§ˆì¼€íŒ… ë°°ë„ˆ */
        .marketing-banner {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 12px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .marketing-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .marketing-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }
        
        .marketing-content {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }
        
        .marketing-coupon {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem;
            border-radius: 8px;
            margin-top: 0.5rem;
            position: relative;
            z-index: 1;
        }
        
        .marketing-btn {
            background: rgba(255,255,255,0.9);
            color: #ff6b6b;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 0.5rem;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }
        
        .marketing-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .marketing-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            z-index: 2;
        }
        
        .marketing-section {
            margin: 2rem 0;
        }
        
        .marketing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .marketing-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
            transition: transform 0.3s ease;
        }
        
        .marketing-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        .marketing-card-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .marketing-card-content {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .marketing-card-btn {
            background: #2196f3;
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s ease;
        }
        
        .marketing-card-btn:hover {
            background: #1976d2;
        }
        
        /* ë…¸ì„ ë³„ ë¶„ì„ í˜ì´ì§€ */
        .analysis-page {
            display: none;
            padding: 1rem;
        }
        
        .analysis-header {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            padding: 1rem;
            margin: 1rem;
            border-radius: 12px;
            text-align: center;
            color: white;
        }
        
        .line-analysis-card {
            background: white;
            margin: 1rem;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .line-chart {
            height: 200px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1rem 0;
            position: relative;
        }
        
        .chart-bar {
            background: #2196f3;
            margin: 0 2px;
            border-radius: 2px 2px 0 0;
            min-height: 20px;
            width: 20px;
            position: relative;
        }
        
        .chart-bar.smooth { background: #4caf50; }
        .chart-bar.normal { background: #ff9800; }
        .chart-bar.congested { background: #f44336; }
        
        /* ì„¤ì • í˜ì´ì§€ */
        .settings-page {
            display: none;
            padding: 1rem;
        }
        
        .settings-header {
            background: linear-gradient(135deg, #9c27b0 0%, #e91e63 100%);
            padding: 1rem;
            margin: 1rem;
            border-radius: 12px;
            text-align: center;
            color: white;
        }
        
        .setting-item {
            background: white;
            margin: 1rem;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .setting-label {
            font-weight: bold;
            color: #333;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #ccc;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle-switch.active {
            background: #2196f3;
        }
        
        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }
        
        .toggle-switch.active .toggle-slider {
            transform: translateX(26px);
        }
        
        /* ì•Œë¦¼ í† ìŠ¤íŠ¸ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            z-index: 1001;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success { background: #4caf50; }
        .toast.error { background: #f44336; }
        .toast.info { background: #2196f3; }
        
        /* ëª¨ë‹¬ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1002;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .route-result-modal .modal-content {
            max-width: 600px;
            text-align: left;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }
        
        .modal-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .modal-btn.primary {
            background: #2196f3;
            color: white;
        }
        
        .modal-btn.secondary {
            background: #f5f5f5;
            color: #333;
        }
        
        /* ì¸ì¦ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .auth-modal-content {
            max-width: 500px;
            width: 90%;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 2rem;
            border-bottom: 1px solid #eee;
        }
        
        .auth-tab {
            flex: 1;
            padding: 1rem;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1rem;
            color: #666;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            color: #2196f3;
            border-bottom-color: #2196f3;
            font-weight: bold;
        }
        
        .auth-form h3 {
            margin-bottom: 1.5rem;
            color: #333;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #2196f3;
            box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
        }
        
        .auth-btn {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .auth-btn.primary {
            background: #2196f3;
            color: white;
        }
        
        .auth-btn.primary:hover {
            background: #1976d2;
        }
        
        .auth-links {
            text-align: center;
            margin-top: 1rem;
        }
        
        .auth-links a {
            color: #2196f3;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .auth-links a:hover {
            text-decoration: underline;
        }
        
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        /* ì‚¬ìš©ì ì •ë³´ ìŠ¤íƒ€ì¼ */
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .user-name {
            font-weight: bold;
            color: #333;
        }
        
        .logout-btn {
            padding: 0.5rem 1rem;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .login-btn {
            padding: 0.5rem 1rem;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        /* ê²½ë¡œ ê²€ìƒ‰ ëª¨ë‹¬ */
        .route-modal-content {
            max-width: 600px;
        }
        
        .route-options {
            margin: 1rem 0;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        
        .checkbox-label input[type="checkbox"] {
            width: auto;
            margin: 0;
        }
        
        /* ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ */
        .favorites-modal-content {
            max-width: 700px;
        }
        
        .favorites-list {
            max-height: 400px;
            overflow-y: auto;
            margin: 1rem 0;
        }
        
        .favorite-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            background: white;
        }
        
        .favorite-route {
            flex: 1;
        }
        
        .favorite-route-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 0.25rem;
        }
        
        .favorite-route-details {
            font-size: 0.9rem;
            color: #666;
        }
        
        .favorite-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .favorite-btn {
            padding: 0.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .favorite-btn.use {
            background: #4caf50;
            color: white;
        }
        
        .favorite-btn.delete {
            background: #f44336;
            color: white;
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 480px) {
            .congestion-cards {
                gap: 0.5rem;
            }
            
            .congestion-card {
                padding: 1rem;
            }
            
            .congestion-circle {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .congestion-percentage {
                font-size: 1.5rem;
            }
            
            .chat-widget {
                width: calc(100% - 40px);
                right: 20px;
                left: 20px;
            }
            
            .chat-fab {
                bottom: 80px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <div class="header">
        <div class="header-top">
            <div class="header-title">êµí†µ í˜„í™©</div>
            <div class="header-icons">
                <div class="weather-info" id="weather-info">
                    <div class="weather-icon" id="weather-icon">ğŸŒ¤ï¸</div>
                    <div class="weather-details">
                        <div class="weather-temp" id="weather-temp">--Â°C</div>
                        <div class="weather-desc" id="weather-desc">ë‚ ì”¨ ë¡œë”© ì¤‘...</div>
                        <div class="rain-warning" id="rain-warning" style="display: none;">
                            <!-- ìš°ì²œ ê²½ê³ ëŠ” JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>
                <div class="user-info" id="user-info" style="display: none;">
                    <span class="user-name" id="user-name">ì‚¬ìš©ì</span>
                    <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
                <button class="login-btn" id="login-btn" onclick="openAuthModal()">ë¡œê·¸ì¸</button>
                <span class="bell-icon">ğŸ””</span>
            </div>
        </div>
    </div>
    
    <!-- ì§€ì—° ì˜ˆìƒ ì•Œë¦¼ -->
    <div class="delay-alert">
        <span class="delay-icon">â˜ï¸</span>
        <span class="delay-text">ìš°ì²œìœ¼ë¡œ ì¸í•œ í‰ê·  5-10ë¶„ ì§€ì—° ì˜ˆìƒ</span>
    </div>
    
    <!-- ì§€í•˜ì²  ì „ìš© í—¤ë” -->
    <div class="subway-header">
        <div class="subway-title">
            <span class="subway-icon">ğŸš‡</span>
            <span>ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ í˜„í™©</span>
        </div>
    </div>
    
    <!-- ì§€í•˜ì²  ì‹¤ì‹œê°„ í˜„í™© -->
    <div id="subway-content">
        <!-- ì‹¤ì‹œê°„ í˜¼ì¡ë„ -->
        <div class="congestion-section">
            <h2 class="section-title">ì‹¤ì‹œê°„ í˜¼ì¡ë„</h2>
            <div class="congestion-cards" id="congestion-cards">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>
        
        <!-- ì§€í•˜ì²  ë…¸ì„ ë³„ í˜„í™© -->
        <div class="lines-section">
            <h2 class="section-title">ì§€í•˜ì²  ë…¸ì„ ë³„ í˜„í™©</h2>
            <div id="lines-container">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>
        
        <!-- ë¹ ë¥¸ ë©”ë‰´ -->
        <div class="quick-menu">
            <h2 class="section-title">ë¹ ë¥¸ ë©”ë‰´</h2>
            <div class="quick-menu-grid">
                <div class="quick-menu-btn" onclick="openRouteSearch()">
                    <div class="quick-menu-icon">ğŸš¶</div>
                    <div class="quick-menu-text">ê²½ë¡œ ê²€ìƒ‰</div>
                </div>
                <div class="quick-menu-btn" onclick="openFavorites()">
                    <div class="quick-menu-icon">ğŸ”–</div>
                    <div class="quick-menu-text">ì¦ê²¨ì°¾ê¸°</div>
                </div>
                <div class="quick-menu-btn" onclick="refreshData()">
                    <div class="quick-menu-icon">ğŸ”„</div>
                    <div class="quick-menu-text">ë°ì´í„° ìƒˆë¡œê³ ì¹¨</div>
                </div>
                <div class="quick-menu-btn" onclick="openChat()">
                    <div class="quick-menu-icon">ğŸ’¬</div>
                    <div class="quick-menu-text">ì‹¤ì‹œê°„ ì±„íŒ…</div>
                </div>
            </div>
        </div>
        
        <!-- ë§ˆì¼€íŒ… ì„¹ì…˜ -->
        <div class="marketing-section">
            <h2 class="section-title">ğŸ ìŠ¤ë§ˆíŠ¸ í˜œíƒ</h2>
            
            <!-- í˜¼ì¡ ì‹œê°„ëŒ€ í• ì¸ ë°°ë„ˆ -->
            <div id="congestion-banner" class="marketing-banner" style="display: none;">
                <button class="marketing-close" onclick="closeMarketingBanner('congestion-banner')">&times;</button>
                <div class="marketing-title">ğŸš‡ í˜¼ì¡ ì‹œê°„ëŒ€ íŠ¹ë³„ í• ì¸!</div>
                <div class="marketing-content">ì§€ê¸ˆ ê·¼ì²˜ ì¹´í˜ì—ì„œ 20% í• ì¸ ì¿ í°ì„ ë°›ì•„ë³´ì„¸ìš”!</div>
                <div class="marketing-coupon">
                    <strong>COFFEE20</strong> - ì•„ë©”ë¦¬ì¹´ë…¸ 20% í• ì¸
                </div>
                <button class="marketing-btn" onclick="useCoupon('COFFEE20')">ì¿ í° ì‚¬ìš©í•˜ê¸°</button>
            </div>
            
            <!-- ë§ˆì¼€íŒ… ì¹´ë“œ ê·¸ë¦¬ë“œ -->
            <div class="marketing-grid">
                <div class="marketing-card">
                    <div class="marketing-card-title">â˜• ê·¼ì²˜ ì¹´í˜ í• ì¸</div>
                    <div class="marketing-card-content">
                        í˜¼ì¡í•œ ì‹œê°„ëŒ€ì— ê·¼ì²˜ ì¹´í˜ì—ì„œ íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”!<br>
                        ì‹¤ì‹œê°„ í• ì¸ ì¿ í°ì„ ì œê³µí•©ë‹ˆë‹¤.
                    </div>
                    <button class="marketing-card-btn" onclick="showNearbyCafes()">ê·¼ì²˜ ì¹´í˜ ë³´ê¸°</button>
                </div>
                
                <div class="marketing-card">
                    <div class="marketing-card-title">ğŸšŒ ëŒ€ì•ˆ êµí†µìˆ˜ë‹¨</div>
                    <div class="marketing-card-content">
                        ì§€í•˜ì²  ì§€ì—° ì‹œ ë¹ ë¥¸ ëŒ€ì•ˆì„ ì°¾ì•„ë³´ì„¸ìš”!<br>
                        ë²„ìŠ¤, íƒì‹œ, ì¹´ì…°ì–´ë§ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                    </div>
                    <button class="marketing-card-btn" onclick="showAlternativeTransport()">ëŒ€ì•ˆ ì°¾ê¸°</button>
                </div>
                
                <div class="marketing-card">
                    <div class="marketing-card-title">ğŸ›ï¸ ì—­ì„¸ê¶Œ ì‡¼í•‘</div>
                    <div class="marketing-card-content">
                        ì§€í•˜ì² ì—­ ê·¼ì²˜ ì‡¼í•‘ëª°ê³¼ ìƒì  ì •ë³´!<br>
                        íŠ¹ë³„ í• ì¸ ì •ë³´ë„ í•¨ê»˜ ì œê³µí•©ë‹ˆë‹¤.
                    </div>
                    <button class="marketing-card-btn" onclick="showNearbyShopping()">ì‡¼í•‘ ì •ë³´</button>
                </div>
                
                <div class="marketing-card">
                    <div class="marketing-card-title">ğŸ½ï¸ ë§›ì§‘ ì¶”ì²œ</div>
                    <div class="marketing-card-content">
                        í˜„ì¬ ìœ„ì¹˜ ê·¼ì²˜ ë§›ì§‘ì„ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤!<br>
                        ì˜ˆì•½ ê°€ëŠ¥í•œ ì‹ë‹¹ ì •ë³´ë„ í™•ì¸í•˜ì„¸ìš”.
                    </div>
                    <button class="marketing-card-btn" onclick="showNearbyRestaurants()">ë§›ì§‘ ë³´ê¸°</button>
                </div>
            </div>
        </div>
        
        <!-- ìµœê·¼ ì—…ë°ì´íŠ¸ -->
        <div class="recent-updates">
            <h2 class="section-title">ìµœê·¼ ì—…ë°ì´íŠ¸</h2>
            <div class="update-card">
                <div class="update-time" id="update-time">ë°ì´í„° ë¡œë”© ì¤‘...</div>
                <div class="update-message" id="update-message">ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  ìˆìŠµë‹ˆë‹¤</div>
            </div>
        </div>
    </div>
    
    <!-- ë…¸ì„ ë³„ ë¶„ì„ í˜ì´ì§€ -->
    <div id="analysis-page" class="analysis-page">
        <div class="analysis-header">
            <h2>ğŸ“ˆ ë…¸ì„ ë³„ ìƒì„¸ ë¶„ì„</h2>
            <p>ê° ë…¸ì„ ì˜ í˜¼ì¡ë„ íŒ¨í„´ê³¼ í†µê³„ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>1í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line1-chart">
                <div class="chart-bar smooth" style="height: 60px;"></div>
                <div class="chart-bar normal" style="height: 80px;"></div>
                <div class="chart-bar congested" style="height: 40px;"></div>
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar normal" style="height: 90px;"></div>
                <div class="chart-bar congested" style="height: 50px;"></div>
                <div class="chart-bar smooth" style="height: 65px;"></div>
                <div class="chart-bar normal" style="height: 75px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ë³´í†µ (65%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 8-9ì‹œ, ì˜¤í›„ 6-7ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>2í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line2-chart">
                <div class="chart-bar smooth" style="height: 80px;"></div>
                <div class="chart-bar normal" style="height: 60px;"></div>
                <div class="chart-bar congested" style="height: 30px;"></div>
                <div class="chart-bar smooth" style="height: 85px;"></div>
                <div class="chart-bar normal" style="height: 70px;"></div>
                <div class="chart-bar congested" style="height: 35px;"></div>
                <div class="chart-bar smooth" style="height: 75px;"></div>
                <div class="chart-bar normal" style="height: 65px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ì›í™œ (72%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 7-8ì‹œ, ì˜¤í›„ 5-6ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>3í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line3-chart">
                <div class="chart-bar normal" style="height: 70px;"></div>
                <div class="chart-bar congested" style="height: 90px;"></div>
                <div class="chart-bar congested" style="height: 95px;"></div>
                <div class="chart-bar normal" style="height: 75px;"></div>
                <div class="chart-bar congested" style="height: 85px;"></div>
                <div class="chart-bar congested" style="height: 100px;"></div>
                <div class="chart-bar normal" style="height: 80px;"></div>
                <div class="chart-bar congested" style="height: 90px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> í˜¼ì¡ (85%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 8-9ì‹œ, ì˜¤í›„ 6-8ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>4í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line4-chart">
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar smooth" style="height: 75px;"></div>
                <div class="chart-bar normal" style="height: 60px;"></div>
                <div class="chart-bar smooth" style="height: 80px;"></div>
                <div class="chart-bar normal" style="height: 65px;"></div>
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar smooth" style="height: 75px;"></div>
                <div class="chart-bar normal" style="height: 60px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ì›í™œ (70%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 7-8ì‹œ, ì˜¤í›„ 5-6ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>5í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line5-chart">
                <div class="chart-bar normal" style="height: 70px;"></div>
                <div class="chart-bar normal" style="height: 75px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
                <div class="chart-bar normal" style="height: 80px;"></div>
                <div class="chart-bar normal" style="height: 65px;"></div>
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar normal" style="height: 75px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ë³´í†µ (68%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 7-9ì‹œ, ì˜¤í›„ 6-7ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>6í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line6-chart">
                <div class="chart-bar smooth" style="height: 60px;"></div>
                <div class="chart-bar smooth" style="height: 65px;"></div>
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar smooth" style="height: 75px;"></div>
                <div class="chart-bar normal" style="height: 55px;"></div>
                <div class="chart-bar smooth" style="height: 65px;"></div>
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ì›í™œ (65%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 8-9ì‹œ, ì˜¤í›„ 5-6ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>7í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line7-chart">
                <div class="chart-bar normal" style="height: 65px;"></div>
                <div class="chart-bar normal" style="height: 70px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
                <div class="chart-bar normal" style="height: 75px;"></div>
                <div class="chart-bar normal" style="height: 70px;"></div>
                <div class="chart-bar smooth" style="height: 65px;"></div>
                <div class="chart-bar normal" style="height: 72px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ë³´í†µ (67%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 7-8ì‹œ, ì˜¤í›„ 6-7ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>8í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line8-chart">
                <div class="chart-bar smooth" style="height: 55px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
                <div class="chart-bar smooth" style="height: 65px;"></div>
                <div class="chart-bar smooth" style="height: 70px;"></div>
                <div class="chart-bar normal" style="height: 50px;"></div>
                <div class="chart-bar smooth" style="height: 60px;"></div>
                <div class="chart-bar smooth" style="height: 65px;"></div>
                <div class="chart-bar smooth" style="height: 55px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> ì›í™œ (60%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 8-9ì‹œ, ì˜¤í›„ 5-6ì‹œ</p>
        </div>
        
        <div class="line-analysis-card">
            <h3>9í˜¸ì„  í˜¼ì¡ë„ íŒ¨í„´</h3>
            <div class="line-chart" id="line9-chart">
                <div class="chart-bar normal" style="height: 70px;"></div>
                <div class="chart-bar congested" style="height: 85px;"></div>
                <div class="chart-bar congested" style="height: 90px;"></div>
                <div class="chart-bar normal" style="height: 75px;"></div>
                <div class="chart-bar congested" style="height: 80px;"></div>
                <div class="chart-bar congested" style="height: 88px;"></div>
                <div class="chart-bar normal" style="height: 72px;"></div>
                <div class="chart-bar congested" style="height: 82px;"></div>
            </div>
            <p><strong>í‰ê·  í˜¼ì¡ë„:</strong> í˜¼ì¡ (81%)</p>
            <p><strong>ìµœê³  í˜¼ì¡ ì‹œê°„:</strong> ì˜¤ì „ 7-9ì‹œ, ì˜¤í›„ 6-8ì‹œ</p>
        </div>
    </div>
    
    <!-- ì„¤ì • í˜ì´ì§€ -->
    <div id="settings-page" class="settings-page">
        <div class="settings-header">
            <h2>âš™ï¸ ì„¤ì •</h2>
            <p>ì•± ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ì‹¤ì‹œê°„ ì•Œë¦¼</div>
            <div class="toggle-switch active" onclick="toggleSetting(this)">
                <div class="toggle-slider"></div>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ì§€ì—° ì•Œë¦¼</div>
            <div class="toggle-switch active" onclick="toggleSetting(this)">
                <div class="toggle-slider"></div>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ìë™ ìƒˆë¡œê³ ì¹¨</div>
            <div class="toggle-switch" onclick="toggleSetting(this)">
                <div class="toggle-slider"></div>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ë‹¤í¬ ëª¨ë“œ</div>
            <div class="toggle-switch" onclick="toggleSetting(this)">
                <div class="toggle-slider"></div>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ì§„ë™ ì•Œë¦¼</div>
            <div class="toggle-switch active" onclick="toggleSetting(this)">
                <div class="toggle-slider"></div>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ìœ„ì¹˜ ê¸°ë°˜ ì•Œë¦¼</div>
            <div class="toggle-switch" onclick="toggleSetting(this)">
                <div class="toggle-slider"></div>
            </div>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">ì•± ì •ë³´</div>
            <div style="color: #666; font-size: 0.9rem;">
                ë²„ì „ 1.0.0<br>
                ì„œìš¸êµí†µê³µì‚¬ ì œê³µ
            </div>
        </div>
    </div>
    
    <!-- ì‹¤ì‹œê°„ ì±„íŒ… ìœ„ì ¯ -->
    <button class="chat-fab" onclick="toggleChat()">ğŸ’¬</button>
    
    <div id="chat-widget" class="chat-widget">
        <div class="chat-header">
            <div class="chat-title">ì‹¤ì‹œê°„ ì±„íŒ…</div>
            <div class="chat-line-selector">
                <select id="chat-line-selector" onchange="switchChatLine()">
                    <option value="all">ì „ì²´</option>
                    <option value="1">1í˜¸ì„ </option>
                    <option value="2">2í˜¸ì„ </option>
                    <option value="3">3í˜¸ì„ </option>
                    <option value="4">4í˜¸ì„ </option>
                    <option value="5">5í˜¸ì„ </option>
                    <option value="6">6í˜¸ì„ </option>
                    <option value="7">7í˜¸ì„ </option>
                    <option value="8">8í˜¸ì„ </option>
                    <option value="9">9í˜¸ì„ </option>
                </select>
            </div>
            <button class="chat-close" onclick="toggleChat()">Ã—</button>
        </div>
        <div class="chat-info" id="chat-info">
            <span class="chat-line-info" id="chat-line-info">ì „ì²´ ì±„íŒ…ë°©</span>
            <span class="chat-user-count" id="chat-user-count">ì˜¨ë¼ì¸: 0ëª…</span>
        </div>
        <div class="chat-messages" id="chat-messages">
            <!-- ì‚¬ìš©ìë“¤ë¼ë¦¬ë§Œ ì±„íŒ… - ì´ˆê¸° ë©”ì‹œì§€ ì œê±° -->
        </div>
        <div class="chat-input">
            <input type="text" id="chat-input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleChatKeyPress(event)">
            <button class="chat-send-btn" onclick="sendChatMessage()">ì „ì†¡</button>
        </div>
    </div>
    
    <!-- ì•Œë¦¼ í† ìŠ¤íŠ¸ -->
    <div id="toast" class="toast"></div>
    
    <!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… ëª¨ë‹¬ -->
    <div id="auth-modal" class="modal">
        <div class="modal-content auth-modal-content">
            <!-- X ë²„íŠ¼ ì¶”ê°€ -->
            <button class="modal-close" onclick="closeAuthModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
            
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">ë¡œê·¸ì¸</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">íšŒì›ê°€ì…</button>
            </div>
            
            <!-- ë¡œê·¸ì¸ í¼ -->
            <div id="login-form" class="auth-form">
                <h3>ë¡œê·¸ì¸</h3>
                <form onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label>ì´ë©”ì¼</label>
                        <input type="email" id="login-email" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label>ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="login-password" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <button type="submit" class="auth-btn primary">ë¡œê·¸ì¸</button>
                </form>
                <div class="auth-links">
                    <a href="#" onclick="showForgotPassword()">ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”?</a>
                </div>
            </div>
            
            <!-- íšŒì›ê°€ì… í¼ -->
            <div id="register-form" class="auth-form" style="display: none;">
                <h3>íšŒì›ê°€ì…</h3>
                <form onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label>ì´ë¦„</label>
                        <input type="text" id="register-name" required placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label>ì´ë©”ì¼</label>
                        <input type="email" id="register-email" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="form-group">
                        <label>ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="register-password" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" minlength="6">
                    </div>
                    <div class="form-group">
                        <label>ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                        <input type="password" id="register-confirm-password" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <button type="submit" class="auth-btn primary">íšŒì›ê°€ì…</button>
                </form>
            </div>
            
            <button class="modal-close" onclick="closeAuthModal()">Ã—</button>
        </div>
    </div>
    
    <!-- ê²½ë¡œ ê²€ìƒ‰ ëª¨ë‹¬ -->
    <div id="route-modal" class="modal">
        <div class="modal-content route-modal-content">
            <div class="modal-title">ê²½ë¡œ ê²€ìƒ‰</div>
            <form onsubmit="searchRoute(event)">
                <div class="form-group">
                    <label>ì¶œë°œì§€</label>
                    <input type="text" id="departure-station" placeholder="ì¶œë°œì—­ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                <div class="form-group">
                    <label>ë„ì°©ì§€</label>
                    <input type="text" id="arrival-station" placeholder="ë„ì°©ì—­ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                <div class="form-group">
                    <label>ì¶œë°œ ì‹œê°„</label>
                    <input type="time" id="departure-time" value="">
                </div>
                <div class="route-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="save-to-favorites">
                        ì¦ê²¨ì°¾ê¸°ì— ì €ì¥
                    </label>
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="modal-btn primary">ê²½ë¡œ ê²€ìƒ‰</button>
                    <button type="button" class="modal-btn secondary" onclick="closeRouteModal()">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ -->
    <div id="favorites-modal" class="modal">
        <div class="modal-content favorites-modal-content">
            <div class="modal-title">ì¦ê²¨ì°¾ê¸° ê²½ë¡œ</div>
            <div class="favorites-list" id="favorites-list">
                <!-- ì¦ê²¨ì°¾ê¸° ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeFavoritesModal()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>
    
    <!-- ëª¨ë‹¬ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-title" id="modal-title">ì•Œë¦¼</div>
            <div id="modal-message"></div>
            <div class="modal-buttons">
                <button class="modal-btn primary" onclick="closeModal()">í™•ì¸</button>
                <button class="modal-btn secondary" onclick="closeModal()">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchNav('realtime')">
            <div class="nav-icon">ğŸ•</div>
            <div class="nav-text">ì‹¤ì‹œê°„ í˜„í™©</div>
        </div>
        <div class="nav-item" onclick="switchNav('analysis')">
            <div class="nav-icon">ğŸ“ˆ</div>
            <div class="nav-text">ë…¸ì„ ë³„ ë¶„ì„</div>
        </div>
        <div class="nav-item" onclick="openChat()">
            <div class="nav-icon">ğŸ’¬</div>
            <div class="nav-text">ì‹¤ì‹œê°„ ì±„íŒ…</div>
        </div>
        <div class="nav-item" onclick="switchNav('settings')">
            <div class="nav-icon">âš™ï¸</div>
            <div class="nav-text">ì„¤ì •</div>
        </div>
    </div>
    
    <script>
        // ê°•ì œ ìºì‹œ ë¬´íš¨í™” ë° ì‹¤í–‰ ìˆœì„œ ë³´ì¥
        console.log('ğŸš‡ ì„œìš¸ ì§€í•˜ì²  ëŒ€ì‹œë³´ë“œ ë¡œë“œë¨ - ' + new Date().toLocaleTimeString());
        console.log('ğŸ”„ ìºì‹œ ë¬´íš¨í™” ë²„ì „ v2 - ' + Date.now());
        
        // API ì„¤ì •
        const SUBWAY_API_KEY = '78674e696f64686439354646555a65';
        const SUBWAY_BASE_URL = 'http://openapi.seoul.go.kr:8088';
        
        // ë‚ ì”¨ API ì„¤ì • (OpenWeatherMap ì‚¬ìš© ì˜ˆì‹œ)
        const WEATHER_API_KEY = 'AtzvOregQ2ic7zq3oHNoig'; // ì‹¤ì œ ë‚ ì”¨ API í‚¤
        const WEATHER_BASE_URL = 'https://api.openweathermap.org/data/2.5';
        
        // ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ëˆˆê³¼ ë¹„ë§Œ ì¸¡ì •)
        async function fetchWeatherData() {
            try {
                const response = await fetch(`${WEATHER_BASE_URL}/weather?q=Seoul&appid=${WEATHER_API_KEY}&units=metric&lang=kr`);
                const data = await response.json();
                
                // ëˆˆê³¼ ë¹„ ìƒíƒœë§Œ í™•ì¸
                const weatherMain = data.weather[0].main;
                const isSnowing = weatherMain === 'Snow';
                const isRaining = weatherMain === 'Rain' || weatherMain === 'Drizzle';
                
                return {
                    temperature: Math.round(data.main.temp),
                    description: data.weather[0].description,
                    humidity: data.main.humidity,
                    rainProbability: data.rain ? (data.rain['1h'] || 0) : 0,
                    snowProbability: data.snow ? (data.snow['1h'] || 0) : 0,
                    icon: data.weather[0].icon,
                    isRaining: isRaining,
                    isSnowing: isSnowing,
                    precipitationType: getPrecipitationType(weatherMain, data.rain, data.snow),
                    precipitationIntensity: getPrecipitationIntensity(weatherMain, data.rain, data.snow)
                };
            } catch (error) {
                console.error('ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                return getSampleWeatherData();
            }
        }
        
        // ê°•ìˆ˜ íƒ€ì… íŒë‹¨ (ëˆˆê³¼ ë¹„ë§Œ)
        function getPrecipitationType(weatherMain, rainData, snowData) {
            if (weatherMain === 'Snow') {
                return 'snow';
            } else if (weatherMain === 'Rain' || weatherMain === 'Drizzle') {
                return 'rain';
            }
            return 'none';
        }
        
        // ê°•ìˆ˜ ê°•ë„ íŒë‹¨ (ëˆˆê³¼ ë¹„ë§Œ)
        function getPrecipitationIntensity(weatherMain, rainData, snowData) {
            if (weatherMain === 'Snow') {
                const snowAmount = snowData ? (snowData['1h'] || 0) : 0;
                if (snowAmount > 5) return 'heavy'; // ê°•í•œ ëˆˆ
                if (snowAmount > 2) return 'moderate'; // ë³´í†µ ëˆˆ
                return 'light'; // ê°€ë²¼ìš´ ëˆˆ
            } else if (weatherMain === 'Rain') {
                const rainAmount = rainData ? (rainData['1h'] || 0) : 0;
                if (rainAmount > 10) return 'heavy'; // ê°•í•œ ë¹„
                if (rainAmount > 5) return 'moderate'; // ë³´í†µ ë¹„
                return 'light'; // ê°€ë²¼ìš´ ë¹„
            } else if (weatherMain === 'Drizzle') {
                return 'light'; // ì´ìŠ¬ë¹„
            }
            return 'none';
        }
        
        // ìƒ˜í”Œ ë‚ ì”¨ ë°ì´í„°
        function getSampleWeatherData() {
            const now = new Date();
            const hour = now.getHours();
            
            // ì‹œê°„ëŒ€ë³„ ë‚ ì”¨ ì‹œë®¬ë ˆì´ì…˜
            let weather = {
                temperature: 15,
                description: 'ë§‘ìŒ',
                humidity: 60,
                rainProbability: 0,
                icon: '01d',
                isRaining: false,
                rainIntensity: 'none'
            };
            
            // ì˜¤ì „/ì˜¤í›„ì— ë”°ë¼ ì˜¨ë„ ë³€í™”
            if (hour >= 6 && hour <= 12) {
                weather.temperature = 12 + Math.floor(Math.random() * 8);
            } else if (hour >= 13 && hour <= 18) {
                weather.temperature = 18 + Math.floor(Math.random() * 6);
            } else {
                weather.temperature = 8 + Math.floor(Math.random() * 8);
            }
            
            // ëœë¤ ë‚ ì”¨ ì¡°ê±´
            const weatherConditions = [
                { description: 'ë§‘ìŒ', icon: '01d', isRaining: false, rainIntensity: 'none' },
                { description: 'êµ¬ë¦„ ì¡°ê¸ˆ', icon: '02d', isRaining: false, rainIntensity: 'none' },
                { description: 'íë¦¼', icon: '04d', isRaining: false, rainIntensity: 'none' },
                { description: 'ê°€ë²¼ìš´ ë¹„', icon: '10d', isRaining: true, rainIntensity: 'light' },
                { description: 'ë³´í†µ ë¹„', icon: '10d', isRaining: true, rainIntensity: 'moderate' },
                { description: 'ê°•í•œ ë¹„', icon: '10d', isRaining: true, rainIntensity: 'heavy' }
            ];
            
            const randomWeather = weatherConditions[Math.floor(Math.random() * weatherConditions.length)];
            weather.description = randomWeather.description;
            weather.icon = randomWeather.icon;
            weather.isRaining = randomWeather.isRaining;
            weather.rainIntensity = randomWeather.rainIntensity;
            weather.humidity = randomWeather.isRaining ? 80 + Math.floor(Math.random() * 20) : 50 + Math.floor(Math.random() * 30);
            weather.rainProbability = randomWeather.isRaining ? 60 + Math.floor(Math.random() * 40) : Math.floor(Math.random() * 20);
            
            return weather;
        }
        
        // ìƒ˜í”Œ ë°ì´í„° (API ì‹¤íŒ¨ ì‹œ ì‚¬ìš©)
        const sampleData = {
            congestion_stats: { smooth: 42, normal: 35, congested: 23 },
            line_status: {
                '1': { status: 'normal', status_text: 'ë³´í†µ', description: 'ì„œìš¸ì—­ â†” ì²­ëŸ‰ë¦¬ êµ¬ê°„ ì§€ì—°', avg_passengers: 25000 },
                '2': { status: 'smooth', status_text: 'ì›í• ', description: 'ì •ìƒ ìš´í–‰ ì¤‘', avg_passengers: 18000 },
                '3': { status: 'congested', status_text: 'í˜¼ì¡', description: 'ê°•ë‚¨ â†” êµëŒ€ êµ¬ê°„ ì‹¬í•œ ì§€ì—°', avg_passengers: 38000 },
                '4': { status: 'smooth', status_text: 'ì›í• ', description: 'ì •ìƒ ìš´í–‰ ì¤‘', avg_passengers: 16000 },
                '5': { status: 'normal', status_text: 'ë³´í†µ', description: 'ì¼ì‚°ì„  ì¼ë¶€ êµ¬ê°„ ì§€ì—°', avg_passengers: 22000 },
                '6': { status: 'smooth', status_text: 'ì›í• ', description: 'ì •ìƒ ìš´í–‰ ì¤‘', avg_passengers: 15000 },
                '7': { status: 'normal', status_text: 'ë³´í†µ', description: 'ì¥ì•”ì„  ì¼ë¶€ ì§€ì—°', avg_passengers: 19000 },
                '8': { status: 'smooth', status_text: 'ì›í• ', description: 'ì •ìƒ ìš´í–‰ ì¤‘', avg_passengers: 14000 },
                '9': { status: 'normal', status_text: 'ë³´í†µ', description: '9í˜¸ì„  ì¼ë¶€ êµ¬ê°„ ì§€ì—°', avg_passengers: 21000 }
            },
            stations: 338,
            passenger_data: 500
        };
        
        // ë„¤ë¹„ê²Œì´ì…˜ ì „í™˜
        function switchNav(nav) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.nav-item').classList.add('active');
            
            // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            document.getElementById('subway-content').style.display = 'none';
            document.getElementById('analysis-page').style.display = 'none';
            document.getElementById('settings-page').style.display = 'none';
            
            // ì„ íƒëœ í˜ì´ì§€ ë³´ì´ê¸°
            if (nav === 'realtime') {
                document.getElementById('subway-content').style.display = 'block';
            } else if (nav === 'analysis') {
                document.getElementById('analysis-page').style.display = 'block';
            } else if (nav === 'settings') {
                document.getElementById('settings-page').style.display = 'block';
            }
            
            console.log('ë„¤ë¹„ê²Œì´ì…˜:', nav);
        }
        
        // ë¹ ë¥¸ ë©”ë‰´ ê¸°ëŠ¥
        function openRouteSearch() {
            console.log('ê²½ë¡œ ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ë¨');
            const modal = document.getElementById('route-modal');
            if (modal) {
                modal.style.display = 'flex';
                console.log('ê²½ë¡œ ê²€ìƒ‰ ëª¨ë‹¬ ì—´ë¦¼');
            } else {
                console.error('route-modal ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                alert('ê²½ë¡œ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤! ğŸš¶â€â™‚ï¸');
            }
        }
        
        function openFavorites() {
            console.log('ì¦ê²¨ì°¾ê¸° ë²„íŠ¼ í´ë¦­ë¨');
            const modal = document.getElementById('favorites-modal');
            if (modal) {
                modal.style.display = 'flex';
                loadFavorites();
                console.log('ì¦ê²¨ì°¾ê¸° ëª¨ë‹¬ ì—´ë¦¼');
            } else {
                console.error('favorites-modal ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                alert('ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤! ğŸ”–');
            }
        }
        
        function openChat() {
            toggleChat();
        }
        
        // ì±„íŒ… ìœ„ì ¯ í† ê¸€
        function toggleChat() {
            const chatWidget = document.getElementById('chat-widget');
            const chatFab = document.querySelector('.chat-fab');
            
            if (chatWidget.style.display === 'none' || chatWidget.style.display === '') {
                chatWidget.style.display = 'flex';
                chatFab.style.display = 'none';
                document.getElementById('chat-input').focus();
            } else {
                chatWidget.style.display = 'none';
                chatFab.style.display = 'block';
            }
        }
        
        // ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }
        
        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message) {
                // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€ (ë…¸ì„ ë³„ ì±„íŒ… ì§€ì›)
                const user = JSON.parse(localStorage.getItem('user'));
                const senderName = user ? user.name : 'ìµëª…';
                addChatMessage(message, senderName, currentChatLine);
                input.value = '';
                
                // ë´‡ ì‘ë‹µ ì œê±° - ì‚¬ìš©ìë“¤ë¼ë¦¬ë§Œ ì±„íŒ…
                console.log('ì‚¬ìš©ì ë©”ì‹œì§€ ì „ì†¡:', message, 'ë°œì‹ ì:', senderName, 'ë…¸ì„ :', currentChatLine);
            }
        }
        
        // ê¸°ì¡´ addChatMessage í•¨ìˆ˜ëŠ” ìœ„ì—ì„œ ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ êµì²´ë¨
        
        function getBotResponse(userMessage) {
            const responses = [
                'ë„¤, ë„ì›€ì´ í•„ìš”í•˜ì‹œë©´ ì–¸ì œë“  ë§ì”€í•´ ì£¼ì„¸ìš”! ğŸ˜Š',
                'ì§€í•˜ì²  ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ìƒì„¸íˆ ì•Œë ¤ë“œë¦´ê²Œìš”.',
                'ì‹¤ì‹œê°„ êµí†µ ì •ë³´ëŠ” 30ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.',
                'í˜¼ì¡ë„ê°€ ë†’ì€ ì‹œê°„ëŒ€ëŠ” ì˜¤ì „ 7-9ì‹œ, ì˜¤í›„ 5-7ì‹œì…ë‹ˆë‹¤.',
                'ë” ìì„¸í•œ ì •ë³´ê°€ í•„ìš”í•˜ì‹œë©´ ì„¤ì •ì—ì„œ ì•Œë¦¼ì„ ì¼œì£¼ì„¸ìš”.',
                'ì„œìš¸ ì§€í•˜ì² ì€ 1-4í˜¸ì„ ì´ ê°€ì¥ ì£¼ìš” ë…¸ì„ ì…ë‹ˆë‹¤.',
                'ì§€ì—° ì •ë³´ëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ë‹ˆ ì°¸ê³ í•´ ì£¼ì„¸ìš”.'
            ];
            
            // í‚¤ì›Œë“œ ê¸°ë°˜ ì‘ë‹µ
            if (userMessage.includes('í˜¼ì¡') || userMessage.includes('ì§€ì—°')) {
                return 'í˜„ì¬ 3í˜¸ì„ ì´ ê°€ì¥ í˜¼ì¡í•œ ìƒíƒœì…ë‹ˆë‹¤. ë‹¤ë¥¸ ë…¸ì„ ì„ ì´ìš©í•´ë³´ì„¸ìš”.';
            } else if (userMessage.includes('ì‹œê°„') || userMessage.includes('ì–¸ì œ')) {
                return 'ì¶œí‡´ê·¼ ì‹œê°„ëŒ€(ì˜¤ì „ 7-9ì‹œ, ì˜¤í›„ 5-7ì‹œ)ì— ê°€ì¥ í˜¼ì¡í•©ë‹ˆë‹¤.';
            } else if (userMessage.includes('ë…¸ì„ ') || userMessage.includes('í˜¸ì„ ')) {
                return '1-4í˜¸ì„ ì´ ì£¼ìš” ë…¸ì„ ì´ë©°, 2í˜¸ì„ ê³¼ 4í˜¸ì„ ì´ ìƒëŒ€ì ìœ¼ë¡œ ì›í™œí•©ë‹ˆë‹¤.';
            }
            
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        // ìºì‹œ ë²„ìŠ¤íŒ…ì„ ìœ„í•œ íƒ€ì„ìŠ¤íƒ¬í”„
        console.log('íŒŒì¼ ë¡œë“œ ì‹œê°„:', new Date().toLocaleString('ko-KR'));
        console.log('ìºì‹œ ë²„ìŠ¤íŒ… í™œì„±í™”ë¨');
        
        // ë…¸ì„ ë³„ ì±„íŒ… ê¸°ëŠ¥
        let currentChatLine = 'all';
        let chatMessages = {
            'all': [],
            '1': [], '2': [], '3': [], '4': [], '5': [], '6': [], '7': [], '8': [], '9': []
        };
        
        function switchChatLine() {
            const selector = document.getElementById('chat-line-selector');
            currentChatLine = selector.value;
            
            const lineInfo = document.getElementById('chat-line-info');
            const userCount = document.getElementById('chat-user-count');
            
            if (currentChatLine === 'all') {
                lineInfo.textContent = 'ì „ì²´ ì±„íŒ…ë°©';
                userCount.textContent = 'ì˜¨ë¼ì¸: ' + getRandomUserCount() + 'ëª…';
            } else {
                lineInfo.textContent = `${currentChatLine}í˜¸ì„  ì±„íŒ…ë°©`;
                userCount.textContent = 'ì˜¨ë¼ì¸: ' + getRandomUserCount() + 'ëª…';
            }
            
            loadChatMessages();
        }
        
        function getRandomUserCount() {
            return Math.floor(Math.random() * 50) + 10;
        }
        
        function loadChatMessages() {
            const messagesContainer = document.getElementById('chat-messages');
            const messages = chatMessages[currentChatLine];
            
            messagesContainer.innerHTML = '';
            
            // í™˜ì˜ ë©”ì‹œì§€ ì œê±° - ì‚¬ìš©ìë“¤ë¼ë¦¬ë§Œ ì±„íŒ…
            if (messages.length === 0) {
                console.log('ì±„íŒ…ë°© ì´ˆê¸°í™”:', currentChatLine);
            } else {
                messages.forEach(message => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `chat-message ${message.sender === 'bot' ? 'bot' : 'user'} ${message.line ? 'line-specific line-' + message.line : ''}`;
                    
                    if (message.sender !== 'bot') {
                        messageDiv.innerHTML = `
                            <div class="chat-message-header">
                                <span class="chat-sender">${message.sender}</span>
                                <span class="chat-line-badge">${message.line}í˜¸ì„ </span>
                                <span class="chat-timestamp">${message.timestamp}</span>
                            </div>
                            <div class="chat-content">${message.content}</div>
                        `;
                    } else {
                        messageDiv.innerHTML = message.content;
                    }
                    
                    messagesContainer.appendChild(messageDiv);
                });
            }
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function addChatMessage(message, sender, line = null) {
            const messageObj = {
                content: message,
                sender: sender,
                line: line,
                timestamp: new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' }),
                id: Date.now()
            };
            
            // í˜„ì¬ ì„ íƒëœ ì±„íŒ…ë°©ì— ë©”ì‹œì§€ ì¶”ê°€
            chatMessages[currentChatLine].push(messageObj);
            
            // ì „ì²´ ì±„íŒ…ë°©ì—ë„ ì¶”ê°€ (ì „ì²´ê°€ ì•„ë‹Œ ê²½ìš°)
            if (currentChatLine !== 'all' && line) {
                chatMessages['all'].push(messageObj);
            }
            
            loadChatMessages();
        }
        
        // ì„¤ì • í† ê¸€
        function toggleSetting(element) {
            element.classList.toggle('active');
            const settingName = element.parentElement.querySelector('.setting-label').textContent;
            showToast(`${settingName} ${element.classList.contains('active') ? 'ì¼œì§' : 'êº¼ì§'}`, 'info');
        }
        
        // í† ìŠ¤íŠ¸ ì•Œë¦¼
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // ëª¨ë‹¬ í‘œì‹œ
        function showModal(title, message) {
            console.log('showModal í˜¸ì¶œë¨:', title, message);
            
            // ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ ëª¨ë‹¬ í‘œì‹œ
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');
            const modal = document.getElementById('modal');
            
            if (modalTitle && modalMessage && modal) {
                modalTitle.textContent = title;
                modalMessage.innerHTML = message;
                modal.style.display = 'flex';
                console.log('ëª¨ë‹¬ í‘œì‹œ ì™„ë£Œ');
            } else {
                console.error('ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                console.log('modalTitle:', modalTitle);
                console.log('modalMessage:', modalMessage);
                console.log('modal:', modal);
            }
        }
        
        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }
        
        // ì¸ì¦ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function openAuthModal() {
            console.log('ë¡œê·¸ì¸ ëª¨ë‹¬ ì—´ê¸°');
            document.getElementById('auth-modal').style.display = 'flex';
            
            // ESC í‚¤ë¡œ ë‹«ê¸° ê¸°ëŠ¥ ì¶”ê°€
            document.addEventListener('keydown', handleEscapeKey);
            
            // ë°°ê²½ í´ë¦­ìœ¼ë¡œ ë‹«ê¸° ê¸°ëŠ¥ ì¶”ê°€
            document.getElementById('auth-modal').addEventListener('click', handleBackgroundClick);
        }
        
        function closeAuthModal() {
            console.log('ë¡œê·¸ì¸ ëª¨ë‹¬ ë‹«ê¸°');
            document.getElementById('auth-modal').style.display = 'none';
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
            document.removeEventListener('keydown', handleEscapeKey);
        }
        
        function handleEscapeKey(event) {
            if (event.key === 'Escape') {
                console.log('ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°');
                closeAuthModal();
            }
        }
        
        function handleBackgroundClick(event) {
            // ë°°ê²½ì„ í´ë¦­í–ˆì„ ë•Œë§Œ ë‹«ê¸° (ëª¨ë‹¬ ë‚´ìš© í´ë¦­ ì‹œì—ëŠ” ë‹«ì§€ ì•ŠìŒ)
            if (event.target === event.currentTarget) {
                console.log('ë°°ê²½ í´ë¦­ìœ¼ë¡œ ëª¨ë‹¬ ë‹«ê¸°');
                closeAuthModal();
            }
        }
        
        function switchAuthTab(tab) {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const tabs = document.querySelectorAll('.auth-tab');
            
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if (tab === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            }
        }
        
        function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // ê°„ë‹¨í•œ ë¡œê·¸ì¸ ì‹œë®¬ë ˆì´ì…˜
            if (email && password) {
                const user = {
                    name: email.split('@')[0],
                    email: email,
                    loginTime: new Date().toISOString()
                };
                
                localStorage.setItem('user', JSON.stringify(user));
                updateUserUI(user);
                closeAuthModal();
                showToast('ë¡œê·¸ì¸ ì„±ê³µ!', 'success');
            } else {
                showToast('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
            }
        }
        
        function handleRegister(event) {
            event.preventDefault();
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm-password').value;
            
            if (password !== confirmPassword) {
                showToast('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            if (name && email && password) {
                const user = {
                    name: name,
                    email: email,
                    loginTime: new Date().toISOString()
                };
                
                localStorage.setItem('user', JSON.stringify(user));
                updateUserUI(user);
                closeAuthModal();
                showToast('íšŒì›ê°€ì… ì„±ê³µ!', 'success');
            } else {
                showToast('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
            }
        }
        
        function logout() {
            localStorage.removeItem('user');
            localStorage.removeItem('favorites');
            updateUserUI(null);
            showToast('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }
        
        function updateUserUI(user) {
            const loginBtn = document.getElementById('login-btn');
            const userInfo = document.getElementById('user-info');
            const userName = document.getElementById('user-name');
            
            if (user) {
                loginBtn.style.display = 'none';
                userInfo.style.display = 'flex';
                userName.textContent = user.name;
            } else {
                loginBtn.style.display = 'block';
                userInfo.style.display = 'none';
            }
        }
        
        function showForgotPassword() {
            showModal('ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°', 'ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
        }
        
        // ê²½ë¡œ ê²€ìƒ‰ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function openRouteModal() {
            document.getElementById('route-modal').style.display = 'flex';
            // í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ê¸°ë³¸ê°’ ì„¤ì •
            const now = new Date();
            const timeString = now.toTimeString().slice(0, 5);
            document.getElementById('departure-time').value = timeString;
        }
        
        function closeRouteModal() {
            document.getElementById('route-modal').style.display = 'none';
        }
        
        function searchRoute(event) {
            event.preventDefault();
            console.log('=== ê²½ë¡œ ê²€ìƒ‰ ì‹œì‘ ===');
            console.log('íƒ€ì„ìŠ¤íƒ¬í”„:', new Date().toLocaleString('ko-KR'));
            
            const departure = document.getElementById('departure-station').value;
            const arrival = document.getElementById('arrival-station').value;
            const time = document.getElementById('departure-time').value;
            const saveToFavorites = document.getElementById('save-to-favorites').checked;
            
            console.log('ì…ë ¥ê°’ í™•ì¸:');
            console.log('- ì¶œë°œì§€:', departure);
            console.log('- ë„ì°©ì§€:', arrival);
            console.log('- ì‹œê°„:', time);
            console.log('- ì¦ê²¨ì°¾ê¸°:', saveToFavorites);
            
            if (!departure || !arrival) {
                alert('ì¶œë°œì§€ì™€ ë„ì°©ì§€ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì‹¤ì œ ê²½ë¡œ ìƒì„± í•¨ìˆ˜ í˜¸ì¶œ
            console.log('generateRoute í•¨ìˆ˜ í˜¸ì¶œ ì‹œì‘');
            const route = generateRoute(departure, arrival, time);
            console.log('generateRoute í•¨ìˆ˜ í˜¸ì¶œ ì™„ë£Œ');
            console.log('ìƒì„±ëœ route ê°ì²´:', route);
            
            if (saveToFavorites) {
                saveFavoriteRoute(route);
            }
            
            console.log('showRouteResult í•¨ìˆ˜ í˜¸ì¶œ ì „');
            // showRouteResult í•¨ìˆ˜ í˜¸ì¶œ
            showRouteResult(route);
            console.log('showRouteResult í•¨ìˆ˜ í˜¸ì¶œ í›„');
            
            closeRouteModal();
            console.log('=== ê²½ë¡œ ê²€ìƒ‰ ì™„ë£Œ ===');
        }
        
        
        function generateRoute(departure, arrival, time) {
            // ì‹¤ì œ ì„œìš¸ ì§€í•˜ì²  ì—­ ë°ì´í„° ê¸°ë°˜ ê²½ë¡œ ìƒì„±
            const stations = {
                'ê°•ë‚¨': { line: '2í˜¸ì„ ', code: '222' },
                'ì„œìš¸ì—­': { line: '1í˜¸ì„ ', code: '133' },
                'í™ëŒ€ì…êµ¬': { line: '2í˜¸ì„ ', code: '239' },
                'ì‹ ì´Œ': { line: '2í˜¸ì„ ', code: '240' },
                'ì´ëŒ€': { line: '2í˜¸ì„ ', code: '241' },
                'ì•„í˜„': { line: '2í˜¸ì„ ', code: '242' },
                'ì¶©ì •ë¡œ': { line: '2í˜¸ì„ ', code: '243' },
                'ì‹œì²­': { line: '1í˜¸ì„ ', code: '132' },
                'ì¢…ê°': { line: '1í˜¸ì„ ', code: '131' },
                'ì„ì§€ë¡œì…êµ¬': { line: '2í˜¸ì„ ', code: '202' },
                'ì„ì§€ë¡œ3ê°€': { line: '2í˜¸ì„ ', code: '203' },
                'ì„ì§€ë¡œ4ê°€': { line: '2í˜¸ì„ ', code: '204' },
                'ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›': { line: '2í˜¸ì„ ', code: '205' },
                'ì‹ ë‹¹': { line: '2í˜¸ì„ ', code: '206' },
                'ìƒì™•ì‹­ë¦¬': { line: '2í˜¸ì„ ', code: '207' },
                'ì™•ì‹­ë¦¬': { line: '2í˜¸ì„ ', code: '208' },
                'í•œì–‘ëŒ€': { line: '2í˜¸ì„ ', code: '209' },
                'ëšì„¬': { line: '2í˜¸ì„ ', code: '210' },
                'ì„±ìˆ˜': { line: '2í˜¸ì„ ', code: '211' },
                'ê±´ëŒ€ì…êµ¬': { line: '2í˜¸ì„ ', code: '212' },
                'êµ¬ì˜': { line: '2í˜¸ì„ ', code: '213' },
                'ê´‘ë‚˜ë£¨': { line: '2í˜¸ì„ ', code: '214' },
                'ì²œí˜¸': { line: '2í˜¸ì„ ', code: '215' },
                'ê°•ë™': { line: '2í˜¸ì„ ', code: '216' },
                'ì˜¬ë¦¼í”½ê³µì›': { line: '2í˜¸ì„ ', code: '217' },
                'ë°©ì´': { line: '2í˜¸ì„ ', code: '218' },
                'ì†¡íŒŒ': { line: '2í˜¸ì„ ', code: '219' },
                'ì„ì´Œ': { line: '2í˜¸ì„ ', code: '220' },
                'ì ì‹¤': { line: '2í˜¸ì„ ', code: '221' },
                'ë¬¸ì •': { line: '2í˜¸ì„ ', code: '223' },
                'ì¥ì§€': { line: '2í˜¸ì„ ', code: '224' },
                'ë³µì •': { line: '2í˜¸ì„ ', code: '225' },
                'ì‚°ì„±': { line: '2í˜¸ì„ ', code: '226' },
                'ë‚¨í•œì‚°ì„±ì…êµ¬': { line: '2í˜¸ì„ ', code: '227' },
                'ë‹¨ëŒ€ì˜¤ê±°ë¦¬': { line: '2í˜¸ì„ ', code: '228' },
                'ì‹ í¥': { line: '2í˜¸ì„ ', code: '229' },
                'ìˆ˜ì§„': { line: '2í˜¸ì„ ', code: '230' },
                'ëª¨ë€': { line: '2í˜¸ì„ ', code: '231' },
                'ìˆ˜ìœ ': { line: '4í˜¸ì„ ', code: '413' },
                'ë¯¸ì•„': { line: '4í˜¸ì„ ', code: '414' },
                'ë¯¸ì•„ì‚¬ê±°ë¦¬': { line: '4í˜¸ì„ ', code: '415' },
                'ê¸¸ìŒ': { line: '4í˜¸ì„ ', code: '416' },
                'ì„±ì‹ ì—¬ëŒ€ì…êµ¬': { line: '4í˜¸ì„ ', code: '417' },
                'í•œì„±ëŒ€ì…êµ¬': { line: '4í˜¸ì„ ', code: '418' },
                'í˜œí™”': { line: '4í˜¸ì„ ', code: '419' },
                'ë™ëŒ€ë¬¸': { line: '4í˜¸ì„ ', code: '420' },
                'ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›': { line: '4í˜¸ì„ ', code: '421' },
                'ì¶©ë¬´ë¡œ': { line: '4í˜¸ì„ ', code: '422' },
                'ëª…ë™': { line: '4í˜¸ì„ ', code: '423' },
                'íšŒí˜„': { line: '4í˜¸ì„ ', code: '424' },
                'ì„œìš¸ì—­': { line: '4í˜¸ì„ ', code: '425' },
                'ìˆ™ëŒ€ì…êµ¬': { line: '4í˜¸ì„ ', code: '426' },
                'ì‚¼ê°ì§€': { line: '4í˜¸ì„ ', code: '427' },
                'ì‹ ìš©ì‚°': { line: '4í˜¸ì„ ', code: '428' },
                'ì´ì´Œ': { line: '4í˜¸ì„ ', code: '429' },
                'ë™ì‘': { line: '4í˜¸ì„ ', code: '430' },
                'ì´ì‹ ëŒ€ì…êµ¬': { line: '4í˜¸ì„ ', code: '431' },
                'ì‚¬ë‹¹': { line: '4í˜¸ì„ ', code: '432' },
                'ë‚¨íƒœë ¹': { line: '4í˜¸ì„ ', code: '433' },
                'ì„ ë°”ìœ„': { line: '4í˜¸ì„ ', code: '434' },
                'ê²½ë§ˆê³µì›': { line: '4í˜¸ì„ ', code: '435' },
                'ëŒ€ê³µì›': { line: '4í˜¸ì„ ', code: '436' },
                'ê³¼ì²œ': { line: '4í˜¸ì„ ', code: '437' },
                'ì •ë¶€ê³¼ì²œì²­ì‚¬': { line: '4í˜¸ì„ ', code: '438' },
                'ì¸ë•ì›': { line: '4í˜¸ì„ ', code: '439' },
                'í‰ì´Œ': { line: '4í˜¸ì„ ', code: '440' },
                'ë²”ê³„': { line: '4í˜¸ì„ ', code: '441' },
                'ê¸ˆì •': { line: '4í˜¸ì„ ', code: '442' },
                'ì‚°ë³¸': { line: '4í˜¸ì„ ', code: '443' },
                'ìˆ˜ë¦¬ì‚°': { line: '4í˜¸ì„ ', code: '444' },
                'ëŒ€ì•¼ë¯¸': { line: '4í˜¸ì„ ', code: '445' },
                'ë°˜ì›”': { line: '4í˜¸ì„ ', code: '446' },
                'ìƒë¡ìˆ˜': { line: '4í˜¸ì„ ', code: '447' },
                'í•œëŒ€ì•': { line: '4í˜¸ì„ ', code: '448' },
                'ì¤‘ì•™': { line: '4í˜¸ì„ ', code: '449' },
                'ê³ ì”': { line: '4í˜¸ì„ ', code: '450' },
                'ì´ˆì§€': { line: '4í˜¸ì„ ', code: '451' },
                'ì•ˆì‚°': { line: '4í˜¸ì„ ', code: '452' },
                'ì‹ ê¸¸ì˜¨ì²œ': { line: '4í˜¸ì„ ', code: '453' },
                'ì •ì™•': { line: '4í˜¸ì„ ', code: '454' },
                'ì˜¤ì´ë„': { line: '4í˜¸ì„ ', code: '455' }
            };
            
            // ì¶œë°œì§€ì™€ ë„ì°©ì§€ê°€ ì‹¤ì œ ì—­ì¸ì§€ í™•ì¸
            const departureStation = stations[departure];
            const arrivalStation = stations[arrival];
            
            console.log('ì¶œë°œì—­ ì •ë³´:', departureStation);
            console.log('ë„ì°©ì—­ ì •ë³´:', arrivalStation);
            
            // ì‹¤ì œ ì—­ì´ ì•„ë‹Œ ê²½ìš° ì²˜ë¦¬
            if (!departureStation || !arrivalStation) {
                console.log('ì‹¤ì œ ì—­ì´ ì•„ë‹™ë‹ˆë‹¤. ê¸°ë³¸ ê²½ë¡œ ìƒì„±');
                const route = {
                    id: Date.now(),
                    name: `${departure} â†’ ${arrival}`,
                    departure: departure,
                    arrival: arrival,
                    time: time,
                    totalTime: Math.floor(Math.random() * 30) + 15,
                    transfers: 0,
                    steps: [{
                        line: '1í˜¸ì„ ',
                        stations: [departure, arrival],
                        time: Math.floor(Math.random() * 30) + 15
                    }],
                    congestionLevel: 'ì›í™œ',
                    fare: 1400,
                    createdAt: new Date().toISOString()
                };
                return route;
            }
            
            // ê°•ì œ ë‹¤ì¤‘ ë…¸ì„  ê²½ë¡œ ìƒì„± (í™•ì‹¤í•œ ë²„ì „)
            console.log('ğŸš‡ ê°•ì œ ë‹¤ì¤‘ ë…¸ì„  ê²½ë¡œ ìƒì„± ì‹œì‘');
            console.log('ì¶œë°œì—­:', departure, departureStation.line);
            console.log('ë„ì°©ì—­:', arrival, arrivalStation.line);
            
            // í•­ìƒ 2ê°œ êµ¬ê°„ìœ¼ë¡œ ê°•ì œ ìƒì„±
            const transferStations = ['ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›', 'ì‹œì²­', 'ì¢…ê°', 'ì„ì§€ë¡œ3ê°€', 'ê°•ë‚¨', 'ì‹ ì´Œ'];
            const transferStation = transferStations[Math.floor(Math.random() * transferStations.length)];
            
            console.log('ì„ íƒëœ í™˜ìŠ¹ì—­:', transferStation);
            
            const routeSteps = [
                {
                    line: departureStation.line,
                    stations: [departure, transferStation],
                    time: Math.floor(Math.random() * 20) + 10
                },
                {
                    line: arrivalStation.line,
                    stations: [transferStation, arrival],
                    time: Math.floor(Math.random() * 20) + 10
                }
            ];
            
            const transfers = 1;
            const totalTime = routeSteps[0].time + routeSteps[1].time + 5;
            
            console.log('ğŸš‡ ê°•ì œ ìƒì„±ëœ ê²½ë¡œ ë‹¨ê³„:', routeSteps);
            console.log('ğŸš‡ ê²½ë¡œ ìƒì„± ì™„ë£Œ');
            
            // AI ê¸°ë°˜ í˜¼ì¡ë„ ì˜ˆì¸¡ í•¨ìˆ˜
        function predictCongestionWithAI(hour, dayOfWeek, weather, line, station) {
            console.log('ğŸ¤– AI í˜¼ì¡ë„ ì˜ˆì¸¡ ì‹œì‘');
            console.log('ì…ë ¥ ë°ì´í„°:', { hour, dayOfWeek, weather, line, station });
            
            // ê°„ë‹¨í•œ AI ëª¨ë¸ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ ì‚¬ìš©)
            let baseCongestion = 0.3; // ê¸°ë³¸ í˜¼ì¡ë„
            
            // ì‹œê°„ëŒ€ë³„ ê°€ì¤‘ì¹˜
            const timeWeights = {
                'rush_morning': [7, 8, 9],    // ëŸ¬ì‹œì•„ì›Œ (ì˜¤ì „)
                'rush_evening': [18, 19, 20], // ëŸ¬ì‹œì•„ì›Œ (ì˜¤í›„)
                'normal': [10, 11, 14, 15, 16, 17], // ì¼ë°˜ì‹œê°„
                'low': [0, 1, 2, 3, 4, 5, 6, 21, 22, 23] // ì €ì¡°ì‹œê°„
            };
            
            if (timeWeights.rush_morning.includes(hour) || timeWeights.rush_evening.includes(hour)) {
                baseCongestion += 0.4;
            } else if (timeWeights.normal.includes(hour)) {
                baseCongestion += 0.2;
            }
            
            // ìš”ì¼ë³„ ê°€ì¤‘ì¹˜
            if (dayOfWeek >= 1 && dayOfWeek <= 5) { // í‰ì¼
                baseCongestion += 0.2;
            }
            
            // ë‚ ì”¨ë³„ ê°€ì¤‘ì¹˜
            const weatherWeights = {
                'rain': 0.15,
                'snow': 0.2,
                'sunny': 0.05,
                'cloudy': 0.0
            };
            baseCongestion += weatherWeights[weather] || 0;
            
            // ë…¸ì„ ë³„ ê°€ì¤‘ì¹˜
            const lineWeights = {
                '1í˜¸ì„ ': 0.1,
                '2í˜¸ì„ ': 0.2,  // ê°€ì¥ í˜¼ì¡í•œ ë…¸ì„ 
                '3í˜¸ì„ ': 0.15,
                '4í˜¸ì„ ': 0.1,
                '5í˜¸ì„ ': 0.05,
                '6í˜¸ì„ ': 0.05,
                '7í˜¸ì„ ': 0.1,
                '8í˜¸ì„ ': 0.05,
                '9í˜¸ì„ ': 0.15
            };
            baseCongestion += lineWeights[line] || 0;
            
            // ì—­ë³„ ê°€ì¤‘ì¹˜ (ì£¼ìš” í™˜ìŠ¹ì—­)
            const stationWeights = {
                'ê°•ë‚¨': 0.2,
                'ì‹ ì´Œ': 0.15,
                'ì‹œì²­': 0.15,
                'ì¢…ê°': 0.15,
                'ì„ì§€ë¡œ3ê°€': 0.1,
                'ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›': 0.1,
                'ì™•ì‹­ë¦¬': 0.1,
                'ê±´ëŒ€ì…êµ¬': 0.15,
                'ì ì‹¤': 0.1
            };
            baseCongestion += stationWeights[station] || 0;
            
            // ëœë¤ ë…¸ì´ì¦ˆ ì¶”ê°€ (ì‹¤ì œ í™˜ê²½ ì‹œë®¬ë ˆì´ì…˜)
            const noise = (Math.random() - 0.5) * 0.1;
            baseCongestion += noise;
            
            // 0-1 ë²”ìœ„ë¡œ ì œí•œ
            baseCongestion = Math.max(0, Math.min(1, baseCongestion));
            
            // í˜¼ì¡ë„ ë ˆë²¨ ë³€í™˜
            let congestionLevel;
            if (baseCongestion >= 0.7) {
                congestionLevel = 'í˜¼ì¡';
            } else if (baseCongestion >= 0.4) {
                congestionLevel = 'ë³´í†µ';
            } else {
                congestionLevel = 'ì›í™œ';
            }
            
            console.log('ğŸ¤– AI ì˜ˆì¸¡ ê²°ê³¼:', {
                congestionScore: baseCongestion.toFixed(3),
                congestionLevel: congestionLevel,
                confidence: 'ë†’ìŒ'
            });
            
            return {
                score: baseCongestion,
                level: congestionLevel,
                confidence: 'ë†’ìŒ',
                factors: {
                    time: hour,
                    weather: weather,
                    line: line,
                    station: station
                }
            };
        }
            // AI ê¸°ë°˜ í˜¼ì¡ë„ ì˜ˆì¸¡ ì‚¬ìš©
            const currentHour = new Date().getHours();
            const currentDay = new Date().getDay(); // 0=ì¼ìš”ì¼, 1=ì›”ìš”ì¼, ...
            const currentWeather = weatherData ? weatherData.weatherMain.toLowerCase() : 'sunny';
            
            // AIë¡œ í˜¼ì¡ë„ ì˜ˆì¸¡
            const aiPrediction = predictCongestionWithAI(
                currentHour, 
                currentDay, 
                currentWeather, 
                departureStation.line, 
                departure
            );
            
            const congestionLevel = aiPrediction.level;
            
            const route = {
                id: Date.now(),
                name: `${departure} â†’ ${arrival}`,
                departure: departure,
                arrival: arrival,
                time: time,
                totalTime: totalTime,
                transfers: transfers,
                steps: routeSteps,
                congestionLevel: congestionLevel,
                fare: calculateFare(totalTime, transfers),
                createdAt: new Date().toISOString()
            };
            
            console.log('ìƒì„±ëœ ê²½ë¡œ:', route);
            console.log('ê²½ë¡œ ë‹¨ê³„ ìˆ˜:', routeSteps.length);
            console.log('ê²½ë¡œ ë‹¨ê³„ë“¤:', routeSteps);
            
            return route;
        }
        
        function calculateFare(totalTime, transfers) {
            // ì„œìš¸ ì§€í•˜ì²  ìš”ê¸ˆ ê³„ì‚° (ê¸°ë³¸ìš”ê¸ˆ + ê±°ë¦¬ìš”ê¸ˆ)
            let fare = 1400; // ê¸°ë³¸ìš”ê¸ˆ
            
            if (totalTime > 30) {
                fare += 100; // 10km ì´ˆê³¼
            }
            if (totalTime > 50) {
                fare += 100; // 20km ì´ˆê³¼
            }
            if (transfers > 0) {
                fare += transfers * 100; // í™˜ìŠ¹í•  ë•Œë§ˆë‹¤ ì¶”ê°€ìš”ê¸ˆ
            }
            
            return fare;
        }
        
        function showRouteResult(route) {
            console.log('showRouteResult í˜¸ì¶œë¨:', route);
            console.log('route.steps:', route.steps);
            console.log('route.steps.length:', route.steps.length);
            
            // ê²½ë¡œ ìƒì„¸ ì •ë³´ ìƒì„±
            let routeDetails = '';
            route.steps.forEach((step, index) => {
                console.log(`ë‹¨ê³„ ${index}:`, step);
                routeDetails += `
                    <div style="padding: 0.8rem; border-left: 4px solid #2196f3; background: #f8f9fa; margin-bottom: 0.5rem; border-radius: 4px;">
                        <div style="font-weight: bold; color: #2196f3; margin-bottom: 0.3rem;">
                            ${step.line} ${index > 0 ? '(í™˜ìŠ¹)' : ''}
                        </div>
                        <div style="color: #666; font-size: 0.9rem; margin-bottom: 0.3rem;">
                            ${step.stations.join(' â†’ ')}
                        </div>
                        <div style="color: #999; font-size: 0.8rem;">
                            ì†Œìš”ì‹œê°„: ${step.time}ë¶„
                        </div>
                    </div>
                `;
            });
            
            console.log('ìƒì„±ëœ routeDetails:', routeDetails);
            
            const message = `
                <div style="text-align: left; padding: 1rem;">
                    <h3 style="color: #2196f3; margin-bottom: 1rem;">ğŸš‡ ${route.name}</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: bold; color: #1976d2;">${route.totalTime}ë¶„</div>
                            <div style="font-size: 0.9rem; color: #666;">ì†Œìš”ì‹œê°„</div>
                        </div>
                        <div style="background: ${route.congestionLevel === 'í˜¼ì¡' ? '#ffebee' : route.congestionLevel === 'ë³´í†µ' ? '#fff8e1' : '#e8f5e8'}; padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: bold; color: ${route.congestionLevel === 'í˜¼ì¡' ? '#d32f2f' : route.congestionLevel === 'ë³´í†µ' ? '#f57c00' : '#2e7d32'};">${route.congestionLevel}</div>
                            <div style="font-size: 0.9rem; color: #666;">í˜¼ì¡ë„</div>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <h4 style="color: #1976d2; margin-bottom: 0.5rem;">ğŸš‰ ê²½ë¡œ ìƒì„¸</h4>
                        ${routeDetails}
                    </div>
                    
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button onclick="alert('ì¦ê²¨ì°¾ê¸°ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!')" style="flex: 1; background: #ff9800; color: white; border: none; padding: 0.8rem; border-radius: 8px; font-weight: bold; cursor: pointer;">
                            â­ ì¦ê²¨ì°¾ê¸°
                        </button>
                        <button onclick="alert('ê²½ë¡œ ì •ë³´ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!')" style="flex: 1; background: #4caf50; color: white; border: none; padding: 0.8rem; border-radius: 8px; font-weight: bold; cursor: pointer;">
                            ğŸ“¤ ê³µìœ í•˜ê¸°
                        </button>
                    </div>
                    
                    <div style="background: #e1f5fe; padding: 0.8rem; border-radius: 8px; font-size: 0.85rem; color: #0277bd; margin-top: 1rem;">
                        <div>ğŸ’¡ ì‹¤ì‹œê°„ ì •ë³´ ê¸°ì¤€</div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>ê²€ìƒ‰ ì‹œê°„: ${new Date().toLocaleTimeString('ko-KR')}</span>
                            <span>ì—…ë°ì´íŠ¸: ë°©ê¸ˆ ì „</span>
                        </div>
                    </div>
                </div>
            `;
            
            showModal('ê²½ë¡œ ê²€ìƒ‰ ê²°ê³¼', message);
        }
        
        // ì¦ê²¨ì°¾ê¸°ì— ê²½ë¡œ ì €ì¥
        function saveRouteToFavorites(routeName, departure, arrival) {
            const favorites = JSON.parse(localStorage.getItem('favoriteRoutes') || '[]');
            const newRoute = {
                id: Date.now(),
                name: routeName,
                departure: departure,
                arrival: arrival,
                savedAt: new Date().toLocaleString('ko-KR')
            };
            
            // ì¤‘ë³µ ì²´í¬
            const exists = favorites.some(route => 
                route.departure === departure && route.arrival === arrival
            );
            
            if (exists) {
                alert('ì´ë¯¸ ì¦ê²¨ì°¾ê¸°ì— ì €ì¥ëœ ê²½ë¡œì…ë‹ˆë‹¤.');
                return;
            }
            
            favorites.push(newRoute);
            localStorage.setItem('favoriteRoutes', JSON.stringify(favorites));
            alert('ì¦ê²¨ì°¾ê¸°ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        // ê²½ë¡œ ê³µìœ í•˜ê¸°
        function shareRoute(routeName) {
            const shareText = `ğŸš‡ ${routeName} ê²½ë¡œë¥¼ ì„œìš¸ ì§€í•˜ì²  ì•±ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”!`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'ì„œìš¸ ì§€í•˜ì²  ê²½ë¡œ',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // í´ë¦½ë³´ë“œì— ë³µì‚¬
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('ê²½ë¡œ ì •ë³´ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(() => {
                    alert('ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
            }
        }
        
        // ì¦ê²¨ì°¾ê¸° ê´€ë ¨ í•¨ìˆ˜ë“¤
        function openFavoritesModal() {
            document.getElementById('favorites-modal').style.display = 'flex';
            loadFavorites();
        }
        
        function closeFavoritesModal() {
            document.getElementById('favorites-modal').style.display = 'none';
        }
        
        function loadFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const favoritesList = document.getElementById('favorites-list');
            
            if (favorites.length === 0) {
                favoritesList.innerHTML = '<p style="text-align: center; color: #666; padding: 2rem;">ì €ì¥ëœ ì¦ê²¨ì°¾ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            favoritesList.innerHTML = favorites.map(favorite => `
                <div class="favorite-item">
                    <div class="favorite-route">
                        <div class="favorite-route-name">${favorite.name}</div>
                        <div class="favorite-route-details">
                            ì†Œìš”ì‹œê°„: ${favorite.totalTime}ë¶„ | í™˜ìŠ¹: ${favorite.transfers}íšŒ
                        </div>
                    </div>
                    <div class="favorite-actions">
                        <button class="favorite-btn use" onclick="useFavoriteRoute('${favorite.id}')">ì‚¬ìš©</button>
                        <button class="favorite-btn delete" onclick="deleteFavoriteRoute('${favorite.id}')">ì‚­ì œ</button>
                    </div>
                </div>
            `).join('');
        }
        
        function saveFavoriteRoute(route) {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            favorites.push(route);
            localStorage.setItem('favorites', JSON.stringify(favorites));
            showToast('ì¦ê²¨ì°¾ê¸°ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }
        
        function useFavoriteRoute(routeId) {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const favorite = favorites.find(f => f.id == routeId);
            
            if (favorite) {
                showRouteResult(favorite);
            }
        }
        
        function deleteFavoriteRoute(routeId) {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const filteredFavorites = favorites.filter(f => f.id != routeId);
            localStorage.setItem('favorites', JSON.stringify(filteredFavorites));
            loadFavorites();
            showToast('ì¦ê²¨ì°¾ê¸°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
        }
        
        // ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸
        // ì‚¬ìš©ì ìœ„ì¹˜ ë° ë‚ ì”¨ ê¸°ë°˜ ìš°ì²œ ê²½ê³ 
        let userLocation = null;
        let weatherData = null;
        
        function getUserLocation() {
            return new Promise((resolve, reject) => {
                console.log('ğŸ“ ìœ„ì¹˜ ì •ë³´ ìš”ì²­ ì‹œì‘');
                
                if (!navigator.geolocation) {
                    console.log('ğŸ“ Geolocation API ì§€ì› ì•ˆí•¨ - ì„œìš¸ ê¸°ë³¸ê°’ ì‚¬ìš©');
                    userLocation = { lat: 37.5665, lon: 126.9780, city: 'Seoul' };
                    resolve(userLocation);
                    return;
                }
                
                // íƒ€ì„ì•„ì›ƒ ì„¤ì • (10ì´ˆ)
                const options = {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 300000 // 5ë¶„ ìºì‹œ
                };
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lon: position.coords.longitude,
                            city: 'Current Location'
                        };
                        console.log('ğŸ“ ìœ„ì¹˜ ì •ë³´ íšë“ ì„±ê³µ:', userLocation);
                        resolve(userLocation);
                    },
                    (error) => {
                        console.log('ğŸ“ ìœ„ì¹˜ ì •ë³´ íšë“ ì‹¤íŒ¨:', error.message);
                        console.log('ğŸ“ ì„œìš¸ ê¸°ë³¸ê°’ ì‚¬ìš©');
                        userLocation = { lat: 37.5665, lon: 126.9780, city: 'Seoul' };
                        resolve(userLocation);
                    },
                    options
                );
            });
        }
        
        async function fetchLocationBasedWeather() {
            try {
                console.log('ğŸŒ¤ï¸ ìœ„ì¹˜ ê¸°ë°˜ ë‚ ì”¨ ë°ì´í„° ìš”ì²­ ì‹œì‘');
                
                if (!userLocation) {
                    console.log('ğŸ“ ì‚¬ìš©ì ìœ„ì¹˜ ì—†ìŒ - ìœ„ì¹˜ ì •ë³´ ìš”ì²­');
                    await getUserLocation();
                }
                
                console.log('ğŸ“ ì‚¬ìš©ì ìœ„ì¹˜:', userLocation);
                
                const apiKey = 'AtzvOregQ2ic7zq3oHNoig';
                const url = `https://api.openweathermap.org/data/2.5/weather?lat=${userLocation.lat}&lon=${userLocation.lon}&appid=${apiKey}&units=metric&lang=kr`;
                
                console.log('ğŸŒ API URL:', url);
                
                const response = await fetch(url);
                console.log('ğŸ“¡ API ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`API ì‘ë‹µ ì˜¤ë¥˜: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“Š API ì‘ë‹µ ë°ì´í„°:', data);
                
                weatherData = {
                    temperature: Math.round(data.main.temp),
                    description: data.weather[0].description,
                    humidity: data.main.humidity,
                    rain: data.rain ? data.rain['1h'] || 0 : 0,
                    snow: data.snow ? data.snow['1h'] || 0 : 0,
                    weatherMain: data.weather[0].main,
                    city: data.name,
                    icon: data.weather[0].icon
                };
                
                console.log('âœ… ìœ„ì¹˜ ê¸°ë°˜ ë‚ ì”¨ ë°ì´í„° ì„±ê³µ:', weatherData);
                return weatherData;
            } catch (error) {
                console.error('âŒ ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                
                // í´ë°±: ì„œìš¸ ë‚ ì”¨ ë°ì´í„°
                console.log('ğŸ”„ ì„œìš¸ ë‚ ì”¨ ë°ì´í„°ë¡œ í´ë°± ì‹œë„');
                try {
                    const fallbackUrl = `https://api.openweathermap.org/data/2.5/weather?q=Seoul&appid=${apiKey}&units=metric&lang=kr`;
                    const fallbackResponse = await fetch(fallbackUrl);
                    const fallbackData = await fallbackResponse.json();
                    
                    weatherData = {
                        temperature: Math.round(fallbackData.main.temp),
                        description: fallbackData.weather[0].description,
                        humidity: fallbackData.main.humidity,
                        rain: fallbackData.rain ? fallbackData.rain['1h'] || 0 : 0,
                        snow: fallbackData.snow ? fallbackData.snow['1h'] || 0 : 0,
                        weatherMain: fallbackData.weather[0].main,
                        city: 'Seoul',
                        icon: fallbackData.weather[0].icon
                    };
                    
                    console.log('âœ… ì„œìš¸ í´ë°± ë‚ ì”¨ ë°ì´í„° ì„±ê³µ:', weatherData);
                    return weatherData;
                } catch (fallbackError) {
                    console.error('âŒ í´ë°± ë‚ ì”¨ ë°ì´í„°ë„ ì‹¤íŒ¨:', fallbackError);
                    return null;
                }
            }
        }
        
        function checkRainSnowWarning() {
            if (!weatherData) return false;
            
            // ë¹„ë‚˜ ëˆˆì´ ì˜¤ëŠ” ê²½ìš° ì²´í¬
            const isRaining = weatherData.rain > 0 || weatherData.weatherMain === 'Rain';
            const isSnowing = weatherData.snow > 0 || weatherData.weatherMain === 'Snow';
            const isDrizzle = weatherData.weatherMain === 'Drizzle';
            
            return isRaining || isSnowing || isDrizzle;
        }
        
        function showRainWarning() {
            const warningBanner = document.getElementById('rain-warning');
            
            console.log('ìš°ì²œ ê²½ê³  ì²´í¬ ì‹œì‘');
            console.log('weatherData:', weatherData);
            console.log('checkRainSnowWarning():', checkRainSnowWarning());
            
            if (warningBanner && weatherData && checkRainSnowWarning()) {
                const rainIntensity = weatherData.rain > 0 ? weatherData.rain : 0;
                const snowIntensity = weatherData.snow > 0 ? weatherData.snow : 0;
                
                let warningText = '';
                if (weatherData.weatherMain === 'Rain' || rainIntensity > 0) {
                    warningText = `ğŸŒ§ï¸ ë¹„ë¡œ ì¸í•œ ì§€í•˜ì²  ì§€ì—° ê°€ëŠ¥ì„± (ê°•ë„: ${rainIntensity}mm/h)`;
                } else if (weatherData.weatherMain === 'Snow' || snowIntensity > 0) {
                    warningText = `â„ï¸ ëˆˆìœ¼ë¡œ ì¸í•œ ì§€í•˜ì²  ì§€ì—° ê°€ëŠ¥ì„± (ê°•ë„: ${snowIntensity}mm/h)`;
                } else if (weatherData.weatherMain === 'Drizzle') {
                    warningText = `ğŸŒ¦ï¸ ì´ìŠ¬ë¹„ë¡œ ì¸í•œ ì§€í•˜ì²  ì§€ì—° ê°€ëŠ¥ì„±`;
                }
                
                warningBanner.innerHTML = `
                    <div class="rain-icon">âš ï¸</div>
                    <div class="rain-text">${warningText}</div>
                    <div class="rain-location">ğŸ“ ${weatherData.city}</div>
                `;
                warningBanner.style.display = 'flex';
                
                console.log('ìš°ì²œ ê²½ê³  í‘œì‹œ:', warningText);
            } else {
                if (warningBanner) {
                    warningBanner.style.display = 'none';
                    console.log('ìš°ì²œ ê²½ê³  ìˆ¨ê¹€ - ì¡°ê±´ ë¯¸ì¶©ì¡±');
                }
            }
        }
        
        async function updateWeatherInfo() {
            try {
                console.log('ğŸŒ¤ï¸ ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹œì‘');
                
                // ìœ„ì¹˜ ê¸°ë°˜ ë‚ ì”¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const locationWeatherData = await fetchLocationBasedWeather();
                
                if (locationWeatherData) {
                    console.log('âœ… ë‚ ì”¨ ë°ì´í„° ë°›ìŒ:', locationWeatherData);
                    
                    // ë‚ ì”¨ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
                    const weatherIcon = document.getElementById('weather-icon');
                    const weatherTemp = document.getElementById('weather-temp');
                    const weatherDesc = document.getElementById('weather-desc');
                    
                    // ì•„ì´ì½˜ ë§¤í•‘
                    const iconMap = {
                        '01d': 'â˜€ï¸', '01n': 'ğŸŒ™',
                        '02d': 'â›…', '02n': 'â˜ï¸',
                        '03d': 'â˜ï¸', '03n': 'â˜ï¸',
                        '04d': 'â˜ï¸', '04n': 'â˜ï¸',
                        '09d': 'ğŸŒ§ï¸', '09n': 'ğŸŒ§ï¸',
                        '10d': 'ğŸŒ¦ï¸', '10n': 'ğŸŒ§ï¸',
                        '11d': 'â›ˆï¸', '11n': 'â›ˆï¸',
                        '13d': 'â„ï¸', '13n': 'â„ï¸',
                        '50d': 'ğŸŒ«ï¸', '50n': 'ğŸŒ«ï¸'
                    };
                    
                    if (weatherIcon) {
                        weatherIcon.textContent = iconMap[locationWeatherData.icon] || 'ğŸŒ¤ï¸';
                        console.log('ğŸ¨ ë‚ ì”¨ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸:', weatherIcon.textContent);
                    }
                    
                    if (weatherTemp) {
                        weatherTemp.textContent = `${locationWeatherData.temperature}Â°C`;
                        console.log('ğŸŒ¡ï¸ ì˜¨ë„ ì—…ë°ì´íŠ¸:', weatherTemp.textContent);
                    }
                    
                    if (weatherDesc) {
                        weatherDesc.textContent = locationWeatherData.description;
                        console.log('ğŸ“ ë‚ ì”¨ ì„¤ëª… ì—…ë°ì´íŠ¸:', weatherDesc.textContent);
                    }
                    
                    // ìœ„ì¹˜ ê¸°ë°˜ ìš°ì²œ ê²½ê³  í‘œì‹œ (ë¹„/ëˆˆì´ ì˜¬ ë•Œë§Œ)
                    showRainWarning();
                } else {
                    console.log('âŒ ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    
                    // ê¸°ë³¸ê°’ í‘œì‹œ
                    const weatherIcon = document.getElementById('weather-icon');
                    const weatherTemp = document.getElementById('weather-temp');
                    const weatherDesc = document.getElementById('weather-desc');
                    
                    if (weatherIcon) weatherIcon.textContent = 'ğŸŒ¤ï¸';
                    if (weatherTemp) weatherTemp.textContent = '--Â°C';
                    if (weatherDesc) weatherDesc.textContent = 'ë‚ ì”¨ ì •ë³´ ì—†ìŒ';
                    
                    // ìš°ì²œ ê²½ê³  ìˆ¨ê¸°ê¸°
                    const warningBanner = document.getElementById('rain-warning');
                    if (warningBanner) {
                        warningBanner.style.display = 'none';
                        console.log('âš ï¸ ìš°ì²œ ê²½ê³  ìˆ¨ê¹€ - ë°ì´í„° ì—†ìŒ');
                    }
                }
                
                console.log('ğŸŒ¤ï¸ ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);
                
                // ì—ëŸ¬ ì‹œ ê¸°ë³¸ê°’ í‘œì‹œ
                const weatherIcon = document.getElementById('weather-icon');
                const weatherTemp = document.getElementById('weather-temp');
                const weatherDesc = document.getElementById('weather-desc');
                
                if (weatherIcon) weatherIcon.textContent = 'ğŸŒ¤ï¸';
                if (weatherTemp) weatherTemp.textContent = '--Â°C';
                if (weatherDesc) weatherDesc.textContent = 'ë‚ ì”¨ ì •ë³´ ì˜¤ë¥˜';
                
                // ìš°ì²œ ê²½ê³  ìˆ¨ê¸°ê¸°
                const warningBanner = document.getElementById('rain-warning');
                if (warningBanner) {
                    warningBanner.style.display = 'none';
                    console.log('âš ï¸ ìš°ì²œ ê²½ê³  ìˆ¨ê¹€ - ì—ëŸ¬ ë°œìƒ');
                }
            }
        }
        
        // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshData() {
            console.log('ğŸ”„ ìˆ˜ë™ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            const refreshBtn = event.target.closest('.quick-menu-btn');
            const originalText = refreshBtn.querySelector('.quick-menu-text').textContent;
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            refreshBtn.querySelector('.quick-menu-text').textContent = 'ìƒˆë¡œê³ ì¹¨ ì¤‘...';
            refreshBtn.style.opacity = '0.6';
            
            try {
                await loadSubwayData();
                refreshBtn.querySelector('.quick-menu-text').textContent = 'ì™„ë£Œ!';
                setTimeout(() => {
                    refreshBtn.querySelector('.quick-menu-text').textContent = originalText;
                    refreshBtn.style.opacity = '1';
                }, 2000);
            } catch (error) {
                console.error('ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜:', error);
                refreshBtn.querySelector('.quick-menu-text').textContent = 'ì˜¤ë¥˜ ë°œìƒ';
                setTimeout(() => {
                    refreshBtn.querySelector('.quick-menu-text').textContent = originalText;
                    refreshBtn.style.opacity = '1';
                }, 2000);
            }
        }
        
        // ì‹¤ì‹œê°„ ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜
        async function loadSubwayData() {
            try {
                console.log('ğŸš‡ ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘');
                
                // ë¡œë”© ìƒíƒœ í‘œì‹œ
                showLoading();
                
                // 2ì´ˆ ëŒ€ê¸° (ì‹¤ì œ API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜)
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // ì‹¤ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ìƒì„±
                const simulatedData = generateRealTimeData();
                
                // ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸
                updateUIWithSimulatedData(simulatedData);
                
            } catch (error) {
                console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
                updateUIWithSampleData();
            }
        }
        
        // ì‹¤ì‹œê°„ ë°ì´í„° ìƒì„±
        function generateRealTimeData() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            
            // ì‹œê°„ëŒ€ë³„ ê¸°ë³¸ í˜¼ì¡ë„
            let baseCongestion = { smooth: 50, normal: 35, congested: 15 };
            
            // ì¶œí‡´ê·¼ ì‹œê°„ëŒ€ í˜¼ì¡ë„ ì¦ê°€
            if ((hour >= 7 && hour <= 9) || (hour >= 18 && hour <= 20)) {
                baseCongestion = { smooth: 25, normal: 45, congested: 30 };
            }
            // ì ì‹¬ì‹œê°„ í˜¼ì¡ë„ ì¦ê°€
            else if (hour >= 12 && hour <= 14) {
                baseCongestion = { smooth: 35, normal: 50, congested: 15 };
            }
            
            // ëœë¤ ë³€ë™ ì¶”ê°€ (Â±5%)
            const variation = () => Math.floor(Math.random() * 10) - 5;
            const congestion = {
                smooth: Math.max(0, Math.min(100, baseCongestion.smooth + variation())),
                normal: Math.max(0, Math.min(100, baseCongestion.normal + variation())),
                congested: Math.max(0, Math.min(100, baseCongestion.congested + variation()))
            };
            
            // ë…¸ì„ ë³„ ìƒíƒœ ìƒì„±
            const lineStatus = {
                '1': generateLineStatus('1', hour),
                '2': generateLineStatus('2', hour),
                '3': generateLineStatus('3', hour),
                '4': generateLineStatus('4', hour),
                '5': generateLineStatus('5', hour),
                '6': generateLineStatus('6', hour),
                '7': generateLineStatus('7', hour),
                '8': generateLineStatus('8', hour),
                '9': generateLineStatus('9', hour)
            };
            
            return {
                congestion_stats: congestion,
                line_status: lineStatus,
                stations: 338,
                passenger_data: Math.floor(Math.random() * 200) + 300,
                timestamp: now.toISOString()
            };
        }
        
        // ë…¸ì„ ë³„ ìƒíƒœ ìƒì„±
        function generateLineStatus(lineNum, hour) {
            const lineNames = {
                '1': 'ì„œìš¸ì—­ â†” ì²­ëŸ‰ë¦¬',
                '2': 'ì„±ìˆ˜ â†” ì‹ ì •ë„¤ê±°ë¦¬',
                '3': 'ëŒ€í™” â†” ìˆ˜ì„œ',
                '4': 'ë‹¹ê³ ê°œ â†” ì˜¤ì´ë„',
                '5': 'ë°©í™” â†” ë§ˆì²œ',
                '6': 'ì‘ì•”ìˆœí™˜ì„ ',
                '7': 'ì¥ì•” â†” ë¶€í‰êµ¬ì²­',
                '8': 'ì•”ì‚¬ â†” ëª¨ë€',
                '9': 'ê°œí™” â†” ì¤‘ì•™ë³´í›ˆë³‘ì›'
            };
            
            // ì‹œê°„ëŒ€ë³„ ê¸°ë³¸ ìƒíƒœ (ê²½ë¡œ ê²€ìƒ‰ê³¼ ë™ì¼í•œ ê¸°ì¤€ ì‚¬ìš©)
            let baseStatus = 'smooth';
            let description = 'ì •ìƒ ìš´í–‰ ì¤‘';
            
            // ëŸ¬ì‹œì•„ì›Œ ì‹œê°„ëŒ€ (7-9ì‹œ, 18-20ì‹œ) - í˜¼ì¡
            if ((hour >= 7 && hour <= 9) || (hour >= 18 && hour <= 20)) {
                if (lineNum === '2' || lineNum === '3' || lineNum === '9') {
                    baseStatus = 'congested';
                    description = `${lineNames[lineNum]} êµ¬ê°„ ì‹¬í•œ ì§€ì—°`;
                } else if (lineNum === '1' || lineNum === '5' || lineNum === '7') {
                    baseStatus = 'congested';
                    description = `${lineNames[lineNum]} êµ¬ê°„ ì§€ì—°`;
                } else {
                    baseStatus = 'normal';
                    description = `${lineNames[lineNum]} êµ¬ê°„ ì§€ì—°`;
                }
            }
            // ì˜¤ì „/ì˜¤í›„ ì‹œê°„ëŒ€ (9-11ì‹œ, 14-16ì‹œ) - ë³´í†µ
            else if ((hour >= 9 && hour <= 11) || (hour >= 14 && hour <= 16)) {
                if (lineNum === '2' || lineNum === '3' || lineNum === '9') {
                    baseStatus = 'normal';
                    description = `${lineNames[lineNum]} êµ¬ê°„ ì§€ì—°`;
                } else {
                    baseStatus = 'smooth';
                    description = 'ì •ìƒ ìš´í–‰ ì¤‘';
                }
            }
            // ì ì‹¬ì‹œê°„ (11-14ì‹œ) - ë³´í†µ
            else if (hour >= 11 && hour <= 14) {
                if (lineNum === '3' || lineNum === '9') {
                    baseStatus = 'normal';
                    description = `${lineNames[lineNum]} êµ¬ê°„ ì§€ì—°`;
                } else {
                    baseStatus = 'smooth';
                    description = 'ì •ìƒ ìš´í–‰ ì¤‘';
                }
            }
            // ì €ë…/ì•¼ê°„ (20-23ì‹œ) - ë³´í†µ
            else if (hour >= 20 && hour <= 23) {
                if (lineNum === '2' || lineNum === '3') {
                    baseStatus = 'normal';
                    description = `${lineNames[lineNum]} êµ¬ê°„ ì§€ì—°`;
                } else {
                    baseStatus = 'smooth';
                    description = 'ì •ìƒ ìš´í–‰ ì¤‘';
                }
            }
            // ì‹¬ì•¼/ìƒˆë²½ (23-7ì‹œ) - ì›í™œ
            else {
                baseStatus = 'smooth';
                description = 'ì •ìƒ ìš´í–‰ ì¤‘';
            }
            
            // ëœë¤ ì´ë²¤íŠ¸ (10% í™•ë¥ )
            if (Math.random() < 0.1) {
                const events = [
                    { status: 'congested', description: `${lineNames[lineNum]} êµ¬ê°„ ì‹¬í•œ ì§€ì—°` },
                    { status: 'normal', description: `${lineNames[lineNum]} êµ¬ê°„ ì§€ì—°` },
                    { status: 'smooth', description: 'ì •ìƒ ìš´í–‰ ì¤‘' }
                ];
                const event = events[Math.floor(Math.random() * events.length)];
                baseStatus = event.status;
                description = event.description;
            }
            
            const statusTexts = {
                'smooth': 'ì›í• ',
                'normal': 'ë³´í†µ',
                'congested': 'í˜¼ì¡'
            };
            
            return {
                status: baseStatus,
                status_text: statusTexts[baseStatus],
                description: description,
                avg_passengers: Math.floor(Math.random() * 20000) + 15000
            };
        }
        
        // ë¡œë”© ìƒíƒœ í‘œì‹œ
        function showLoading() {
            document.getElementById('congestion-cards').innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            `;
            
            document.getElementById('lines-container').innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            `;
            
            document.getElementById('update-time').textContent = 'ë°ì´í„° ë¡œë”© ì¤‘...';
            document.getElementById('update-message').textContent = 'ì„œìš¸ ì§€í•˜ì²  ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  ìˆìŠµë‹ˆë‹¤';
        }
        
        // ì‹¤ì œ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸
        function updateUIWithRealData(stations, passengers) {
            console.log('ì‹¤ì œ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸');
            
            // í˜¼ì¡ë„ í†µê³„ ê³„ì‚°
            const congestionStats = calculateCongestionStats(passengers);
            
            // í˜¼ì¡ë„ ì¹´ë“œ ì—…ë°ì´íŠ¸
            document.getElementById('congestion-cards').innerHTML = `
                <div class="congestion-card">
                    <div class="congestion-circle circle-smooth">${congestionStats.smooth}%</div>
                    <div class="congestion-label">ì›í• </div>
                </div>
                <div class="congestion-card">
                    <div class="congestion-circle circle-normal">${congestionStats.normal}%</div>
                    <div class="congestion-label">ë³´í†µ</div>
                </div>
                <div class="congestion-card">
                    <div class="congestion-circle circle-congested">${congestionStats.congested}%</div>
                    <div class="congestion-label">í˜¼ì¡</div>
                </div>
            `;
            
            // ë…¸ì„ ë³„ ìƒíƒœ ê³„ì‚°
            const lineStatus = calculateLineStatus(passengers);
            
            // ë…¸ì„ ë³„ í˜„í™© ì—…ë°ì´íŠ¸
            updateLineCards(lineStatus);
            
            // ìµœê·¼ ì—…ë°ì´íŠ¸ ì‹œê°„ ì—…ë°ì´íŠ¸
            const now = new Date();
            document.getElementById('update-time').textContent = `${now.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})} ì—…ë°ì´íŠ¸`;
            document.getElementById('update-message').textContent = `${stations.length}ê°œ ì—­, ${passengers.length}ê°œ ìŠ¹í•˜ì°¨ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ`;
            
            console.log(`âœ… ì‹¤ì œ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸ ì™„ë£Œ - ì—­: ${stations.length}ê°œ, ìŠ¹í•˜ì°¨: ${passengers.length}ê°œ`);
        }
        
        // ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸
        function updateUIWithSimulatedData(data) {
            console.log('ğŸ”„ ì‹¤ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸');
            
            // í˜¼ì¡ë„ ì¹´ë“œ ì—…ë°ì´íŠ¸
            document.getElementById('congestion-cards').innerHTML = `
                <div class="congestion-card">
                    <div class="congestion-circle circle-smooth">${data.congestion_stats.smooth}%</div>
                    <div class="congestion-label">ì›í• </div>
                </div>
                <div class="congestion-card">
                    <div class="congestion-circle circle-normal">${data.congestion_stats.normal}%</div>
                    <div class="congestion-label">ë³´í†µ</div>
                </div>
                <div class="congestion-card">
                    <div class="congestion-circle circle-congested">${data.congestion_stats.congested}%</div>
                    <div class="congestion-label">í˜¼ì¡</div>
                </div>
            `;
            
            // ë…¸ì„ ë³„ í˜„í™© ì—…ë°ì´íŠ¸
            updateLineCards(data.line_status);
            
            // ìµœê·¼ ì—…ë°ì´íŠ¸ ì‹œê°„ ì—…ë°ì´íŠ¸
            const updateTime = new Date(data.timestamp);
            document.getElementById('update-time').textContent = `${updateTime.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})} ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸`;
            document.getElementById('update-message').textContent = `ì„œìš¸ ì§€í•˜ì²  ${data.stations}ê°œ ì—­, ${data.passenger_data}ê°œ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ`;
            
            console.log(`âœ… ì‹¤ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜ ì—…ë°ì´íŠ¸ ì™„ë£Œ - ì—­: ${data.stations}ê°œ, ë°ì´í„°: ${data.passenger_data}ê°œ`);
        }
        
        // ìƒ˜í”Œ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸
        function updateUIWithSampleData() {
            console.log('ìƒ˜í”Œ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸');
            
            // í˜¼ì¡ë„ ì¹´ë“œ ì—…ë°ì´íŠ¸
            document.getElementById('congestion-cards').innerHTML = `
                <div class="congestion-card">
                    <div class="congestion-circle circle-smooth">${sampleData.congestion_stats.smooth}%</div>
                    <div class="congestion-label">ì›í• </div>
                </div>
                <div class="congestion-card">
                    <div class="congestion-circle circle-normal">${sampleData.congestion_stats.normal}%</div>
                    <div class="congestion-label">ë³´í†µ</div>
                </div>
                <div class="congestion-card">
                    <div class="congestion-circle circle-congested">${sampleData.congestion_stats.congested}%</div>
                    <div class="congestion-label">í˜¼ì¡</div>
                </div>
            `;
            
            // ë…¸ì„ ë³„ í˜„í™© ì—…ë°ì´íŠ¸
            updateLineCards(sampleData.line_status);
            
            // ì—…ë°ì´íŠ¸ ì‹œê°„ í‘œì‹œ
            const now = new Date();
            document.getElementById('update-time').textContent = `${now.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})} (ìƒ˜í”Œ ë°ì´í„°)`;
            document.getElementById('update-message').textContent = '3í˜¸ì„  ê°•ë‚¨ì—­ ìŠ¹ê°•ì¥ í˜¼ì¡ë„ ì¦ê°€';
            
            console.log('âœ… ìƒ˜í”Œ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        }
        
        // í˜¼ì¡ë„ í†µê³„ ê³„ì‚°
        function calculateCongestionStats(passengerData) {
            if (!passengerData || passengerData.length === 0) {
                return { smooth: 42, normal: 35, congested: 23 };
            }
            
            const counts = { smooth: 0, normal: 0, congested: 0 };
            
            passengerData.forEach(data => {
                const rideCount = parseInt(data.RIDE_PASGR_NUM || 0);
                const alightCount = parseInt(data.ALIGHT_PASGR_NUM || 0);
                const totalCount = rideCount + alightCount;
                
                if (totalCount < 20000) {
                    counts.smooth++;
                } else if (totalCount < 35000) {
                    counts.normal++;
                } else {
                    counts.congested++;
                }
            });
            
            const total = counts.smooth + counts.normal + counts.congested;
            if (total > 0) {
                return {
                    smooth: Math.round(counts.smooth / total * 100),
                    normal: Math.round(counts.normal / total * 100),
                    congested: Math.round(counts.congested / total * 100)
                };
            }
            
            return { smooth: 42, normal: 35, congested: 23 };
        }
        
        // ë…¸ì„ ë³„ ìƒíƒœ ê³„ì‚°
        function calculateLineStatus(passengerData) {
            const lineStats = {};
            
            passengerData.forEach(data => {
                const lineNum = data.LINE_NUM;
                if (lineNum) {
                    const rideCount = parseInt(data.RIDE_PASGR_NUM || 0);
                    const alightCount = parseInt(data.ALIGHT_PASGR_NUM || 0);
                    const totalCount = rideCount + alightCount;
                    
                    if (!lineStats[lineNum]) {
                        lineStats[lineNum] = { total: 0, count: 0 };
                    }
                    
                    lineStats[lineNum].total += totalCount;
                    lineStats[lineNum].count++;
                }
            });
            
            const result = {};
            Object.keys(lineStats).forEach(lineNum => {
                const stats = lineStats[lineNum];
                if (stats.count > 0) {
                    const avgPassengers = stats.total / stats.count;
                    
                    let status, statusText, description;
                    if (avgPassengers < 20000) {
                        status = 'smooth';
                        statusText = 'ì›í• ';
                        description = 'ì •ìƒ ìš´í–‰ ì¤‘';
                    } else if (avgPassengers < 35000) {
                        status = 'normal';
                        statusText = 'ë³´í†µ';
                        description = 'ì¼ë¶€ êµ¬ê°„ ì§€ì—°';
                    } else {
                        status = 'congested';
                        statusText = 'í˜¼ì¡';
                        description = 'ì‹¬í•œ ì§€ì—°';
                    }
                    
                    result[lineNum] = {
                        status: status,
                        status_text: statusText,
                        description: description,
                        avg_passengers: avgPassengers
                    };
                }
            });
            
            return result;
        }
        
        // ë…¸ì„  ì¹´ë“œ ì—…ë°ì´íŠ¸
        function updateLineCards(lineStatus) {
            const linesContainer = document.getElementById('lines-container');
            linesContainer.innerHTML = '';
            
            // ëª¨ë“  ë…¸ì„ ë“¤ (1-9í˜¸ì„ )
            const defaultLines = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];
            
            defaultLines.forEach(lineNum => {
                const lineData = lineStatus[lineNum] || sampleData.line_status[lineNum];
                const lineCard = document.createElement('div');
                lineCard.className = 'line-card';
                
                lineCard.innerHTML = `
                    <div class="line-info">
                        <div class="line-number line-${lineNum}">${lineNum}</div>
                        <div class="line-details">
                            <h3>${lineNum}í˜¸ì„ </h3>
                            <p>${lineData.description}</p>
                        </div>
                    </div>
                    <div class="line-status">
                        <div class="status-dot status-${lineData.status}"></div>
                        <span class="status-text">${lineData.status_text}</span>
                    </div>
                `;
                
                linesContainer.appendChild(lineCard);
            });
        }
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('êµí†µ í˜„í™© ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì™„ë£Œ');
            
            // ì´ˆê¸° ë°ì´í„° ë¡œë“œ
            loadSubwayData();
            
            // ì´ˆê¸° ë‚ ì”¨ ì •ë³´ ë¡œë“œ
            updateWeatherInfo();
            
            // ì‚¬ìš©ì ì •ë³´ í™•ì¸
            const user = JSON.parse(localStorage.getItem('user'));
            updateUserUI(user);
            
            // 30ì´ˆë§ˆë‹¤ ë°ì´í„° ì—…ë°ì´íŠ¸ (ë” ìì£¼ ë³€ê²½)
            setInterval(loadSubwayData, 30000);
            
            // 10ë¶„ë§ˆë‹¤ ë‚ ì”¨ ì •ë³´ ì—…ë°ì´íŠ¸
            setInterval(updateWeatherInfo, 600000);
            
            // ë§ˆì¼€íŒ… ë°°ë„ˆ ì²´í¬
            checkCongestionAndShowBanner();
        });
        
        // ë§ˆì¼€íŒ… ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showCongestionBanner() {
            const banner = document.getElementById('congestion-banner');
            if (banner) {
                banner.style.display = 'block';
                console.log('í˜¼ì¡ ì‹œê°„ëŒ€ í• ì¸ ë°°ë„ˆ í‘œì‹œ');
            }
        }
        
        function closeMarketingBanner(bannerId) {
            const banner = document.getElementById(bannerId);
            if (banner) {
                banner.style.display = 'none';
                console.log('ë§ˆì¼€íŒ… ë°°ë„ˆ ë‹«ê¸°:', bannerId);
            }
        }
        
        function useCoupon(couponCode) {
            console.log('ì¿ í° ì‚¬ìš©:', couponCode);
            showToast(`ì¿ í° ${couponCode}ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
            
            // ì¿ í° ì‚¬ìš© ê¸°ë¡ ì €ì¥
            const usedCoupons = JSON.parse(localStorage.getItem('usedCoupons') || '[]');
            usedCoupons.push({
                code: couponCode,
                usedAt: new Date().toLocaleString('ko-KR'),
                discount: '20%'
            });
            localStorage.setItem('usedCoupons', JSON.stringify(usedCoupons));
        }
        
        function showNearbyCafes() {
            const cafes = [
                { name: 'ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì ', distance: '200m', discount: '20%' },
                { name: 'íˆ¬ì¸í”Œë ˆì´ìŠ¤', distance: '300m', discount: '15%' },
                { name: 'ì´ë””ì•¼ì»¤í”¼', distance: '150m', discount: '25%' }
            ];
            
            let message = 'â˜• ê·¼ì²˜ ì¹´í˜ ì •ë³´:<br><br>';
            cafes.forEach(cafe => {
                message += `â€¢ ${cafe.name} (${cafe.distance})<br>  í• ì¸: ${cafe.discount}<br><br>`;
            });
            
            showModal('ê·¼ì²˜ ì¹´í˜ í• ì¸ ì •ë³´', message);
        }
        
        function showAlternativeTransport() {
            const alternatives = [
                { type: 'ë²„ìŠ¤', time: '5ë¶„', cost: '1,200ì›', route: '146ë²ˆ' },
                { type: 'íƒì‹œ', time: '8ë¶„', cost: '3,500ì›', route: 'ì§í–‰' },
                { type: 'ì¹´ì…°ì–´ë§', time: '3ë¶„', cost: '2,800ì›', route: 'ì˜ì¹´' }
            ];
            
            let message = 'ğŸšŒ ëŒ€ì•ˆ êµí†µìˆ˜ë‹¨:<br><br>';
            alternatives.forEach(alt => {
                message += `â€¢ ${alt.type}<br>  ì†Œìš”ì‹œê°„: ${alt.time}<br>  ìš”ê¸ˆ: ${alt.cost}<br>  ê²½ë¡œ: ${alt.route}<br><br>`;
            });
            
            showModal('ëŒ€ì•ˆ êµí†µìˆ˜ë‹¨', message);
        }
        
        function showNearbyShopping() {
            const shops = [
                { name: 'ë¡¯ë°ë°±í™”ì ', distance: '500m', discount: '10%' },
                { name: 'í˜„ëŒ€ë°±í™”ì ', distance: '600m', discount: '15%' },
                { name: 'ê°•ë‚¨ì—­ ì§€í•˜ìƒê°€', distance: '100m', discount: '5%' }
            ];
            
            let message = 'ğŸ›ï¸ ì—­ì„¸ê¶Œ ì‡¼í•‘ ì •ë³´:<br><br>';
            shops.forEach(shop => {
                message += `â€¢ ${shop.name} (${shop.distance})<br>  í• ì¸: ${shop.discount}<br><br>`;
            });
            
            showModal('ì‡¼í•‘ ì •ë³´', message);
        }
        
        function showNearbyRestaurants() {
            const restaurants = [
                { name: 'ë§›ìˆëŠ” ì‹ë‹¹', cuisine: 'í•œì‹', rating: '4.5', distance: '200m' },
                { name: 'ì´íƒˆë¦¬ì•ˆ ë ˆìŠ¤í† ë‘', cuisine: 'ì–‘ì‹', rating: '4.3', distance: '300m' },
                { name: 'ì¼ë³¸ ë¼ë©˜ì§‘', cuisine: 'ì¼ì‹', rating: '4.7', distance: '150m' }
            ];
            
            let message = 'ğŸ½ï¸ ê·¼ì²˜ ë§›ì§‘ ì¶”ì²œ:<br><br>';
            restaurants.forEach(restaurant => {
                message += `â€¢ ${restaurant.name}<br>  ì¢…ë¥˜: ${restaurant.cuisine}<br>  í‰ì : ${restaurant.rating}â­<br>  ê±°ë¦¬: ${restaurant.distance}<br><br>`;
            });
            
            showModal('ë§›ì§‘ ì¶”ì²œ', message);
        }
        
        // í˜¼ì¡ë„ì— ë”°ë¥¸ ë§ˆì¼€íŒ… ë°°ë„ˆ í‘œì‹œ
        function checkCongestionAndShowBanner() {
            const currentHour = new Date().getHours();
            const isRushHour = (currentHour >= 7 && currentHour <= 9) || (currentHour >= 18 && currentHour <= 20);
            
            if (isRushHour) {
                // ëœë¤í•˜ê²Œ ë°°ë„ˆ í‘œì‹œ (30% í™•ë¥ )
                if (Math.random() < 0.3) {
                    setTimeout(() => {
                        showCongestionBanner();
                    }, 5000); // 5ì´ˆ í›„ í‘œì‹œ
                }
            }
        }
    </script>
</body>
</html>
